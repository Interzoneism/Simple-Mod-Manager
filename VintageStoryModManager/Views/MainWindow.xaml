<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:design="clr-namespace:VintageStoryModManager.Design"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.modernwpf.com/2019"
    xmlns:services="clr-namespace:VintageStoryModManager.Services"
    xmlns:viewModels="clr-namespace:VintageStoryModManager.ViewModels"
    xmlns:views="clr-namespace:VintageStoryModManager.Views"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    xmlns:converters="clr-namespace:VintageStoryModManager.Converters"
    x:Class="VintageStoryModManager.Views.MainWindow"
    mc:Ignorable="d"
    d:DataContext="{d:DesignInstance Type={x:Type design:MainWindowDesignData}}"
    Title="Simple VS Manager"
    Height="870" Width="1285"
    MinWidth="1200" MinHeight="775" WindowStartupLocation="CenterScreen"
    PreviewKeyDown="MainWindow_OnPreviewKeyDown"
    AllowDrop="True"
    PreviewDragEnter="MainWindow_OnPreviewDragEnter"
    PreviewDragOver="MainWindow_OnPreviewDragOver"
    PreviewDrop="MainWindow_OnPreviewDrop"
    Background="{DynamicResource Brush.Window.Shell.Background.Solid}">

    <Window.Resources>
        <converters:BooleanToVisibilityConverter x:Key="IMM.VisibleWhenTrueConverter" />
        <converters:BooleanToVisibilityConverter x:Key="IMM.VisibleWhenFalseConverter" IsInverted="True" />
        <converters:RowPaddingOffsetConverter x:Key="IMM.RowPaddingOffsetConverter" />
        <Thickness x:Key="IMM.RowPaddingBase">0,0,0,0</Thickness>
        <sys:Double x:Key="IMM.NormalRowHeightOffset">10</sys:Double>
        <sys:Double x:Key="IMM.CompactRowHeightOffset">-12</sys:Double>
        <sys:Double x:Key="IMM.ModDbCardScale">0.75</sys:Double>
        <converters:DownloadMetricDisplayConverter x:Key="IMM.DownloadMetricDisplayConverter" />
        <sys:Double x:Key="IMM.TagRowMaxHeight">70</sys:Double>
        <sys:Double x:Key="IMM.TagRowCompactMaxHeight">35</sys:Double>
        <Style x:Key="IMM.TagBadgeBorderStyle" TargetType="{x:Type Border}">
            <Setter Property="Background" Value="{DynamicResource Brush.Panel.Secondary.Background.Solid}" />
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.Accent.Primary}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="10" />
            <Setter Property="Padding" Value="8,2" />
            <Setter Property="Margin" Value="0,0,0,0" />
        </Style>
        <ItemsPanelTemplate x:Key="IMM.TagItemsPanelTemplate">
            <views:OverlappingTagPanel />
        </ItemsPanelTemplate>
        <ItemsPanelTemplate x:Key="IMM.TagFilterItemsPanelTemplate">
            <UniformGrid Columns="4" HorizontalAlignment="Left" />
        </ItemsPanelTemplate>
        <DataTemplate x:Key="IMM.TagBadgeTemplate">
            <Border Style="{StaticResource IMM.TagBadgeBorderStyle}">
                <TextBlock Text="{Binding}" FontSize="12" Foreground="{DynamicResource Brush.Text.Primary}" />
            </Border>
        </DataTemplate>
        <Style x:Key="IMM.TagFilterToggleButtonStyle" TargetType="{x:Type ToggleButton}">
            <Setter Property="ContentTemplate" Value="{StaticResource IMM.TagBadgeTemplate}" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="Margin" Value="0,0,6,6" />
            <Setter Property="HorizontalAlignment" Value="Stretch" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="HorizontalContentAlignment" Value="Center" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="Opacity" Value="1" />
            <Setter Property="Focusable" Value="False" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Border Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                            <ContentPresenter Content="{TemplateBinding Content}"
                                              ContentTemplate="{TemplateBinding ContentTemplate}"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsChecked" Value="False">
                    <Setter Property="Opacity" Value="0.5" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="IMM.TagHeaderToggleButtonStyle" TargetType="{x:Type ToggleButton}">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="HorizontalAlignment" Value="Stretch" />
            <Setter Property="VerticalAlignment" Value="Stretch" />
            <Setter Property="HorizontalContentAlignment" Value="Left" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="Focusable" Value="False" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Border Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                            <ContentPresenter Content="{TemplateBinding Content}"
                                              ContentTemplate="{TemplateBinding ContentTemplate}"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="IMM.DataGridCellBaseStyle" TargetType="{x:Type DataGridCell}">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0,0,0,0" />
            <Setter Property="Padding" Value="8,6" />
            <Setter Property="Foreground"
                    Value="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Foreground"
                            Value="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="IMM.PrimaryDataGridColumnHeaderStyle" TargetType="{x:Type DataGridColumnHeader}">
            <Setter Property="Background" Value="{DynamicResource Brush.DataGrid.Header.Background}" />
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.Panel.Secondary.Background.Solid}" />
            <Setter Property="BorderThickness" Value="1,0,0,1" />
            <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
            <Setter Property="Margin" Value="0,0,0,6" />
            <Setter Property="Padding" Value="12,10" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="HorizontalContentAlignment" Value="Left" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type DataGridColumnHeader}">
                        <Border x:Name="HeaderBorder"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                SnapsToDevicePixels="True">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <ContentPresenter Grid.Column="0"
                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                                <Path x:Name="SortArrow"
                                      Grid.Column="1"
                                      Width="6"
                                      Height="6"
                                      Margin="6,0,0,0"
                                      Fill="{DynamicResource Brush.Accent.Primary}"
                                      Stretch="Uniform"
                                      Visibility="Collapsed"
                                      VerticalAlignment="Center" />
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="HeaderBorder" Property="Background"
                                        Value="{DynamicResource Brush.DataGrid.Header.Background.Hover}" />
                            </Trigger>
                            <Trigger Property="SortDirection" Value="Ascending">
                                <Setter TargetName="SortArrow" Property="Visibility" Value="Visible" />
                                <Setter TargetName="SortArrow" Property="Data" Value="M 0 3 L 3 0 6 3 Z" />
                            </Trigger>
                            <Trigger Property="SortDirection" Value="Descending">
                                <Setter TargetName="SortArrow" Property="Visibility" Value="Visible" />
                                <Setter TargetName="SortArrow" Property="Data" Value="M 0 0 L 3 3 6 0 Z" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="IMM.ModTabButtonBaseStyle"
               TargetType="{x:Type Button}"
               BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="{DynamicResource Brush.ModTabs.Background}" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Opacity" Value="0.5" />
            <Setter Property="Padding" Value="12,6" />
            <Setter Property="VerticalContentAlignment" Value="Top" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="ButtonBackground"
                                Background="{TemplateBinding Background}"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              RecognizesAccessKey="True" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="ButtonBackground" Property="Opacity" Value="0.5" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="IMM.InstalledTabButtonStyle"
               TargetType="{x:Type Button}"
               BasedOn="{StaticResource IMM.ModTabButtonBaseStyle}">
            <Style.Triggers>
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding SearchModDatabase}" Value="False" />
                        <Condition Binding="{Binding IsViewingCloudModlists}" Value="False" />
                    </MultiDataTrigger.Conditions>
                    <Setter Property="Opacity" Value="1" />
                </MultiDataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="IMM.ModDatabaseTabButtonStyle"
               TargetType="{x:Type Button}"
               BasedOn="{StaticResource IMM.ModTabButtonBaseStyle}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding SearchModDatabase}" Value="True">
                    <Setter Property="Opacity" Value="1" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="IMM.ModDatabaseDownloadsTabButtonStyle"
               TargetType="{x:Type Button}"
               BasedOn="{StaticResource IMM.ModTabButtonBaseStyle}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsModDatabaseDownloadsTabSelected}" Value="True">
                    <Setter Property="Opacity" Value="1" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="IMM.ModDatabaseActivityTabButtonStyle"
               TargetType="{x:Type Button}"
               BasedOn="{StaticResource IMM.ModTabButtonBaseStyle}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsModDatabaseActivityTabSelected}" Value="True">
                    <Setter Property="Opacity" Value="1" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="IMM.ModlistsTabButtonStyle"
               TargetType="{x:Type Button}"
               BasedOn="{StaticResource IMM.ModTabButtonBaseStyle}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsViewingCloudModlists}" Value="True">
                    <Setter Property="Opacity" Value="1" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="IMM.ModlistsTabItemStyle"
               TargetType="{x:Type TabItem}">
            <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
            <Setter Property="Background" Value="{DynamicResource Brush.ModTabs.Background}" />
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.SunkenSurface.Bevel.Dark}" />
            <Setter Property="BorderThickness" Value="1,1,1,0" />
            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
            <Setter Property="VerticalContentAlignment" Value="Stretch" />
            <Setter Property="Padding" Value="20,10" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabItem}">
                        <Grid SnapsToDevicePixels="True" Background="Transparent">
                            <Border x:Name="TabBorder"
                                    Margin="0,0,0,-1"
                                    CornerRadius="6,6,0,0"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}">
                                        <ContentPresenter x:Name="ContentSite"
                                                  ContentSource="Header"
                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                  Margin="{TemplateBinding Padding}"
                                                  TextElement.FontSize="16"
                                                  RecognizesAccessKey="True" />
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Panel.ZIndex" Value="1" />
                                <Setter TargetName="TabBorder" Property="Background"
                                        Value="{DynamicResource Brush.Panel.Primary.Background.Solid}" />
                                <Setter TargetName="TabBorder" Property="BorderBrush"
                                        Value="{DynamicResource Brush.Accent.Primary}" />
                                <Setter Property="FontWeight" Value="SemiBold" />
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="TabBorder" Property="Background"
                                        Value="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Subtle}" />
                                <Setter TargetName="TabBorder" Property="Opacity" Value="0.6" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Menu item style shared by toggle and standard items -->
        <Style x:Key="ToggleMenuItemStyle" TargetType="{x:Type MenuItem}">
            <Setter Property="Background" Value="{DynamicResource Brush.Panel.Primary.Background.Solid}" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="12,0,12,0" />
            <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <Grid SnapsToDevicePixels="True">
                            <Border x:Name="templateRoot"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Padding="{TemplateBinding Padding}"
                                    SnapsToDevicePixels="True">
                                <Grid Grid.IsSharedSizeScope="True">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemCheckColumnGroup" />
                                        <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIconColumnGroup" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIGTColumnGroup" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock x:Name="CheckMark"
                                               Margin="0,0,8,0"
                                               VerticalAlignment="Center"
                                               FontFamily="{TemplateBinding FontFamily}"
                                               FontSize="{TemplateBinding FontSize}"
                                               Foreground="{TemplateBinding Foreground}"
                                               Text="â˜"
                                               Visibility="Collapsed" />

                                    <ContentPresenter x:Name="Icon"
                                                      Grid.Column="1"
                                                      Margin="0,0,8,0"
                                                      VerticalAlignment="Center"
                                                      ContentSource="Icon"
                                                      RecognizesAccessKey="True"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />

                                    <ContentPresenter x:Name="HeaderHost"
                                                      Grid.Column="2"
                                                      VerticalAlignment="Center"
                                                      RecognizesAccessKey="True"
                                                      ContentSource="Header"
                                                      TextElement.Foreground="{TemplateBinding Foreground}" />

                                    <TextBlock x:Name="InputGestureText"
                                               Grid.Column="3"
                                               Margin="24,0,0,0"
                                               VerticalAlignment="Center"
                                               Foreground="{TemplateBinding Foreground}"
                                               Text="{TemplateBinding InputGestureText}"
                                               Visibility="Visible" />

                                    <TextBlock x:Name="ArrowGlyph"
                                               Grid.Column="4"
                                               Margin="24,0,0,0"
                                               VerticalAlignment="Center"
                                               Foreground="{TemplateBinding Foreground}"
                                               Text="â–¶"
                                               Visibility="Collapsed" />
                                </Grid>
                            </Border>

                            <Popup x:Name="SubMenuPopup"
                                   AllowsTransparency="True"
                                   Focusable="False"
                                   Placement="Right"
                                   PlacementTarget="{Binding ElementName=templateRoot}"
                                   HorizontalOffset="-2"
                                   VerticalOffset="-3"
                                   IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}">
                                <Border Margin="0,0,0,4"
                                        Background="{DynamicResource Brush.Panel.Primary.Background.Solid}"
                                        BorderBrush="{DynamicResource Brush.Accent.Primary}"
                                        BorderThickness="1"
                                        MinWidth="{Binding ActualWidth, ElementName=templateRoot}"
                                        SnapsToDevicePixels="True">
                                    <ScrollViewer CanContentScroll="False"
                                                  Focusable="False"
                                                  HorizontalScrollBarVisibility="Hidden"
                                                  VerticalScrollBarVisibility="Auto">
                                        <ItemsPresenter Margin="2" />
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>

                        <ControlTemplate.Triggers>
                            <Trigger SourceName="Icon" Property="Content" Value="{x:Null}">
                                <Setter TargetName="Icon" Property="Visibility" Value="Collapsed" />
                            </Trigger>

                            <Trigger Property="InputGestureText" Value="">
                                <Setter TargetName="InputGestureText" Property="Visibility" Value="Collapsed" />
                            </Trigger>

                            <Trigger Property="InputGestureText" Value="{x:Null}">
                                <Setter TargetName="InputGestureText" Property="Visibility" Value="Collapsed" />
                            </Trigger>

                            <Trigger Property="HasItems" Value="True">
                                <Setter TargetName="ArrowGlyph" Property="Visibility" Value="Visible" />
                            </Trigger>

                            <Trigger Property="Role" Value="TopLevelHeader">
                                <Setter TargetName="SubMenuPopup" Property="Placement" Value="Bottom" />
                                <Setter TargetName="SubMenuPopup" Property="HorizontalOffset" Value="0" />
                                <Setter TargetName="SubMenuPopup" Property="VerticalOffset" Value="0" />
                                <Setter TargetName="ArrowGlyph" Property="Visibility" Value="Collapsed" />
                            </Trigger>

                            <Trigger Property="Role" Value="SubmenuHeader">
                                <Setter TargetName="ArrowGlyph" Property="Text" Value="â–¶" />
                            </Trigger>

                            <Trigger Property="IsCheckable" Value="True">
                                <Setter TargetName="CheckMark" Property="Visibility" Value="Visible" />
                                <Setter Property="StaysOpenOnClick" Value="True" />
                            </Trigger>

                            <Trigger Property="IsCheckable" Value="False">
                                <Setter TargetName="CheckMark" Property="Visibility" Value="Collapsed" />
                                <Setter Property="StaysOpenOnClick" Value="False" />
                            </Trigger>

                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="CheckMark" Property="Visibility" Value="Visible" />
                                <Setter TargetName="CheckMark" Property="Text" Value="ðŸ—¹" />
                            </Trigger>

                            <Trigger Property="IsChecked" Value="False">
                                <Setter TargetName="CheckMark" Property="Text" Value="â˜" />
                            </Trigger>

                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter TargetName="templateRoot" Property="Background"
                                        Value="{DynamicResource Brush.Menu.Item.Background.Hover}" />
                                <Setter TargetName="templateRoot" Property="BorderBrush"
                                        Value="{DynamicResource Brush.Border.Hover}" />
                                <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
                            </Trigger>

                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Placeholder}" />
                            </Trigger>

                            <Trigger Property="IsSubmenuOpen" Value="True">
                                <Setter TargetName="templateRoot" Property="Background"
                                        Value="{DynamicResource Brush.Menu.Item.Background.Hover}" />
                                <Setter TargetName="templateRoot" Property="BorderBrush"
                                        Value="{DynamicResource Brush.Border.Hover}" />
                                <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid x:Name="RootGrid" Margin="0,0,0,8" Background="{DynamicResource Brush.Panel.Primary.Background.Solid}">

        <Grid.RowDefinitions>
            <RowDefinition Height="35" MinHeight="10" />
            <RowDefinition />
            <RowDefinition Height="Auto" MinHeight="40" />
        </Grid.RowDefinitions>
        <Grid x:Name="TOP" Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>


            <Menu Grid.Column="0"
                  IsMainMenu="True"
                  BorderThickness="0"
                  Margin="0,0,0,5"
                  Background="{DynamicResource Brush.Window.Shell.Background.Solid}"
                  Foreground="{DynamicResource Brush.Text.Primary}">
                <Menu.Resources>
                    <Style TargetType="{x:Type MenuItem}" BasedOn="{StaticResource ToggleMenuItemStyle}" />
                </Menu.Resources>

                <MenuItem Header="_File" Height="35">
                    <MenuItem Header="Set _Data Folder..." Height="35" Click="SelectDataFolderMenuItem_OnClick" />
                    <MenuItem Header="Set _Game Folder..." Height="35" Click="SelectGameFolderMenuItem_OnClick" />
                    <MenuItem Header="Set Custom Vintage Story Shortcut" Height="35"
                              Click="SetCustomShortcutMenuItem_OnClick" />
                    <MenuItem x:Name="GameProfilesMenuItem"
                              Header="Game Profiles"
                              Height="35"
                              SubmenuOpened="GameProfilesMenuItem_OnSubmenuOpened">
                        <MenuItem x:Name="CreateGameProfileMenuItem"
                                  Header="Create new..."
                                  Height="35"
                                  Click="CreateGameProfileMenuItem_OnClick" />
                        <MenuItem x:Name="DeleteGameProfileMenuItem"
                                  Header="Delete profile..."
                                  Height="35"
                                  Click="DeleteGameProfileMenuItem_OnClick" />
                    </MenuItem>
                    <MenuItem Header="Restore backup point"
                              Height="35"
                              SubmenuOpened="RestoreBackupMenuItem_OnSubmenuOpened">
                        <MenuItem Header="Loading..." IsEnabled="False" />
                    </MenuItem>
                    <MenuItem x:Name="DisableAutoRefreshMenuItem"
                              Header="_Disable auto-refresh"
                              Height="35"
                              IsCheckable="True"
                              Style="{StaticResource ToggleMenuItemStyle}"
                              Click="DisableAutoRefreshMenuItem_OnClick" />
                    <Separator />
                    <MenuItem Header="E_xit" Height="35" Click="ExitMenuItem_OnClick" />
                </MenuItem>
                <MenuItem Header="_Mods" Height="35" SubmenuOpened="ModsMenuItem_OnSubmenuOpened">
                    <MenuItem Header="_Refresh Mods"
                              Height="35"
                              Command="{Binding RefreshModsUiCommand, RelativeSource={RelativeSource AncestorType=Window}}" />
                    <MenuItem x:Name="UpdateAllModsMenuItem"
                              Header="{Binding DataContext.UpdateAllModsMenuHeader, RelativeSource={RelativeSource AncestorType=Window}, FallbackValue=_Update All Mods}"
                              Height="35"
                              Click="UpdateAllModsMenuItem_OnClick" />
                    <MenuItem Header="Check mods compatibility" Height="35"
                              Click="CheckModsCompatibilityMenuItem_OnClick" />
                    <MenuItem x:Name="RequireExactVsVersionMenuItem"
                              Header="Require exact VS version for compatibility checks"
                              Height="35"
                              IsCheckable="True"
                              Style="{StaticResource ToggleMenuItemStyle}"
                              Click="RequireExactVsVersionMenuItem_OnClick" />
                    <MenuItem x:Name="CacheAllVersionsMenuItem"
                              Header="Cache all versions locally"
                              Height="35"
                              IsCheckable="True"
                              Style="{StaticResource ToggleMenuItemStyle}"
                              Click="CacheAllVersionsMenuItem_OnClick" />
                    <MenuItem x:Name="DeleteCachedModsMenuItem"
                              Header="_Delete Cached Mods"
                              Height="35"
                              Click="DeleteCachedModsMenuItem_OnClick" />
                </MenuItem>
                <MenuItem x:Name="PresetsAndModlistsMenuItem" Header="_Save &amp; Load" Height="35">
                    <MenuItem Header="Save _Modlist as an importable PDF..." Height="35"
                              Click="SaveInstalledModsPdfMenuItem_OnClick" />
                    <MenuItem Header="Save _Modlist..." Height="35" Click="SaveModlistMenuItem_OnClick" />
                    <MenuItem Header="Load _Modlist..." Height="35" Click="LoadModlistMenuItem_OnClick" />
                    <Separator />
                    <MenuItem Header="_Save Preset..." Height="35" Click="SavePresetMenuItem_OnClick" />
                    <MenuItem x:Name="LoadPresetMenuItem"
                              Header="_Load Preset"
                              Height="35"
                              SubmenuOpened="LoadPresetMenuItem_OnSubmenuOpened">
                        <MenuItem x:Name="BrowsePresetMenuItem"
                                  Header="_Browse..."
                                  Height="35"
                                  Click="LoadPresetMenuItem_OnClick" />
                    </MenuItem>
                    <Separator />
                    <MenuItem x:Name="AlwaysClearModlistsMenuItem"
                              Header="Always clear mods before loading Modlist"
                              Height="35"
                              IsCheckable="True"
                              Style="{StaticResource ToggleMenuItemStyle}"
                              Click="AlwaysClearModlistsMenuItem_OnClick" />
                    <MenuItem x:Name="AlwaysAddModlistsMenuItem"
                              Header="Always add to current mods when loading Modlist"
                              Height="35"
                              IsCheckable="True"
                              Style="{StaticResource ToggleMenuItemStyle}"
                              Click="AlwaysAddModlistsMenuItem_OnClick" />
                </MenuItem>
                <MenuItem Header="_View" Height="35">
                    <MenuItem Header="_Compact View"
                              Height="35"
                              IsCheckable="True"
                              Style="{StaticResource ToggleMenuItemStyle}"
                              IsChecked="{Binding IsCompactView, Mode=TwoWay}" />
                    <MenuItem Header="_Use ModDB design"
                              Height="35"
                              IsCheckable="True"
                              Style="{StaticResource ToggleMenuItemStyle}"
                              IsChecked="{Binding UseModDbDesignView, Mode=TwoWay}" />
                    <MenuItem Header="_Themes" Height="35">
                        <MenuItem x:Name="VintageStoryThemeMenuItem"
                                  Header="_Vintage Story"
                                  Height="35"
                                  IsCheckable="True"
                                  Style="{StaticResource ToggleMenuItemStyle}"
                                  Tag="{x:Static services:ColorTheme.VintageStory}"
                                  Click="ThemeMenuItem_OnClick" />
                        <MenuItem x:Name="DarkThemeMenuItem"
                                  Header="_Dark"
                                  Height="35"
                                  IsCheckable="True"
                                  Style="{StaticResource ToggleMenuItemStyle}"
                                  Tag="{x:Static services:ColorTheme.Dark}"
                                  Click="ThemeMenuItem_OnClick" />
                        <MenuItem x:Name="LightThemeMenuItem"
                                  Header="_Light"
                                  Height="35"
                                  IsCheckable="True"
                                  Style="{StaticResource ToggleMenuItemStyle}"
                                  Tag="{x:Static services:ColorTheme.Light}"
                                  Click="ThemeMenuItem_OnClick" />
                        <MenuItem x:Name="CustomThemeMenuItem"
                                  Header="_Custom..."
                                  Height="35"
                                  IsCheckable="True"
                                  Style="{StaticResource ToggleMenuItemStyle}"
                                  Tag="{x:Static services:ColorTheme.Custom}"
                                  Click="ThemeMenuItem_OnClick" />
                        <MenuItem x:Name="SurpriseMeThemeMenuItem"
                                  Header="_Surprise me! (In A Bad Way)"
                                  Height="35"
                                  IsCheckable="True"
                                  Style="{StaticResource ToggleMenuItemStyle}"
                                  Tag="{x:Static services:ColorTheme.SurpriseMe}"
                                  Click="ThemeMenuItem_OnClick" />
                    </MenuItem>
                    <MenuItem x:Name="ColumnsMenuItem"
                              Header="_Columns"
                              Height="35"
                              Visibility="{Binding IsViewingInstalledMods, Converter={StaticResource IMM.VisibleWhenTrueConverter}}">
                        <MenuItem x:Name="ActiveColumnMenuItem"
                                  Header="_Active"
                                  IsCheckable="True"
                                  IsChecked="True"
                                  Style="{StaticResource ToggleMenuItemStyle}"
                                  Checked="InstalledModsColumnMenuItem_OnChecked"
                                  Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                        <MenuItem x:Name="IconColumnMenuItem"
                                  Header="_Icon"
                                  IsCheckable="True"
                                  IsChecked="True"
                                  Style="{StaticResource ToggleMenuItemStyle}"
                                  Checked="InstalledModsColumnMenuItem_OnChecked"
                                  Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                        <MenuItem x:Name="NameColumnMenuItem"
                                  Header="_Name"
                                  IsCheckable="True"
                                  IsChecked="True"
                                  Style="{StaticResource ToggleMenuItemStyle}"
                                  Checked="InstalledModsColumnMenuItem_OnChecked"
                                  Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                        <MenuItem x:Name="VersionColumnMenuItem"
                                  Header="_Version"
                                  IsCheckable="True"
                                  IsChecked="True"
                                  Style="{StaticResource ToggleMenuItemStyle}"
                                  Checked="InstalledModsColumnMenuItem_OnChecked"
                                  Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                        <MenuItem x:Name="LatestVersionColumnMenuItem"
                                  Header="Latest _Version"
                                  IsCheckable="True"
                                  IsChecked="True"
                                  Style="{StaticResource ToggleMenuItemStyle}"
                                  Checked="InstalledModsColumnMenuItem_OnChecked"
                                  Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                        <MenuItem x:Name="AuthorsColumnMenuItem"
                                  Header="_Authors"
                                  IsCheckable="True"
                                  IsChecked="True"
                                  Style="{StaticResource ToggleMenuItemStyle}"
                                  Checked="InstalledModsColumnMenuItem_OnChecked"
                                  Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                        <MenuItem x:Name="TagsColumnMenuItem"
                                  Header="_Tags"
                                  IsCheckable="True"
                                  IsChecked="True"
                                  Style="{StaticResource ToggleMenuItemStyle}"
                                  Checked="InstalledModsColumnMenuItem_OnChecked"
                                  Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                        <MenuItem x:Name="StatusColumnMenuItem"
                                  Header="_Status"
                                  IsCheckable="True"
                                  IsChecked="True"
                                  Style="{StaticResource ToggleMenuItemStyle}"
                                  Checked="InstalledModsColumnMenuItem_OnChecked"
                                  Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                        <MenuItem x:Name="UserReportsColumnMenuItem"
                                  Header="User _Reports"
                                  IsCheckable="True"
                                  IsChecked="True"
                                  Style="{StaticResource ToggleMenuItemStyle}"
                                  Checked="InstalledModsColumnMenuItem_OnChecked"
                                  Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                        <MenuItem x:Name="SideColumnMenuItem"
                                  Header="S_ide"
                                  IsCheckable="True"
                                  IsChecked="True"
                                  Style="{StaticResource ToggleMenuItemStyle}"
                                  Checked="InstalledModsColumnMenuItem_OnChecked"
                                  Unchecked="InstalledModsColumnMenuItem_OnChecked" />
                    </MenuItem>
                </MenuItem>
                <MenuItem Header="_Help &amp; Advanced" Height="35">
                    <MenuItem x:Name="ManagerVersionMenuItem"
                              Header="Version: --"
                              Padding="12,6"
                              IsEnabled="False"
                              Focusable="False"
                              Opacity="0.75" />
                    <MenuItem x:Name="GameVersionMenuItem"
                              Header="Vintage Story: --"
                              Padding="12,6"
                              IsEnabled="False"
                              Focusable="False"
                              Visibility="Collapsed"
                              Opacity="0.75" />
                    <Separator />
                    <MenuItem Header="Open manager config folder"
                              Padding="12,6"
                              Click="ManagerDataFolderMenuItem_OnClick" />
                    <MenuItem Header="Open _Mod DB page for the manager"
                              Padding="12,6"
                              Click="ManagerModDbPageMenuItem_OnClick" />
                    <MenuItem Header="Menu Guide"
                              Padding="12,6"
                              Click="GuideMenuItem_OnClick" />
                    <MenuItem Header="Help!"
                              Padding="12,6"
                              Click="HelpMenuItem_OnClick" />
                    <MenuItem x:Name="DeveloperProfilesMenuItem"
                              Header="Developer Profiles"
                              Padding="12,6"
                              Visibility="Collapsed" />
                    <Separator />
                    <MenuItem x:Name="DisableInternetAccessMenuItem"
                              Header="_Disable Internet Access"
                              Height="35"
                              IsCheckable="True"
                              Style="{StaticResource ToggleMenuItemStyle}"
                              Click="DisableInternetAccessMenuItem_OnClick" />
                    <MenuItem x:Name="EnableServerOptionsMenuItem"
                              Header="Enable server options"
                              Padding="12,6"
                              IsCheckable="True"
                              Style="{StaticResource ToggleMenuItemStyle}"
                              Click="EnableServerOptionsMenuItem_OnClick" />
                    <MenuItem Header="Scan for mod config files"
                              Padding="12,6"
                              Click="ScanForModConfigsMenuItem_OnClick" />
                    <MenuItem Header="Clear temporary cache (Safe to use, nothing important is removed)"
                              Padding="12,6"
                              Click="ClearAllCachesMenuItem_OnClick" />
                    <Separator />
                    <MenuItem Header="Debug: Show all game log lines referencing the selected mod."
                              Padding="12,6"
                              Click="ExperimentalModDebuggingMenuItem_OnClick" />
                    <MenuItem Header="Debug: Show all game log lines found referencing any installed mod"
                              Padding="12,6"
                              Click="ExperimentalAllModsDebuggingMenuItem_OnClick" />
                    <Separator />
                    <MenuItem Header="Delete all Simple VS Manager files (Uninstall)"
                              Padding="12,6"
                              Click="DeleteAllManagerFilesMenuItem_OnClick" />

                </MenuItem>
            </Menu>

            <StackPanel Grid.Column="1"
                        Margin="4,0,4,0"
                        Orientation="Horizontal"
                        VerticalAlignment="Center"
                        HorizontalAlignment="Left">
                <TextBlock x:Name="ManagerUpdateLinkTextBlock"
                           Visibility="Collapsed"
                           Margin="0,0,12,0"
                           VerticalAlignment="Center">
                    <Hyperlink NavigateUri="https://mods.vintagestory.at/simplevsmanager"
                               Foreground="{DynamicResource Brush.Text.Emphasis}"
                               RequestNavigate="ManagerUpdateLink_OnRequestNavigate">
                        Manager update available!
                    </Hyperlink>
                </TextBlock>

                <TextBlock x:Name="ModUsagePromptTextBlock"
                           Visibility="Collapsed"
                           VerticalAlignment="Center">
                    <Hyperlink Foreground="{DynamicResource Brush.Text.Emphasis}"
                               Click="ModUsagePromptLink_OnClick">
                        Confirm working mods!
                    </Hyperlink>
                </TextBlock>
            </StackPanel>


        </Grid>

        <TextBlock x:Name="ActiveGameProfileTextBlock"
                   Grid.Row="1"
                   Margin="16,8,0,0"
                   FontSize="17"
                   FontWeight="SemiBold"
                   Padding="3,0,0,3"
                   Foreground="{DynamicResource Brush.Text.Primary}"
                   Text="Profile: Default"
                   Visibility="Collapsed"
                   Opacity="0.5"
                   HorizontalAlignment="Left"
                   VerticalAlignment="Top" />

        <Grid x:Name="MIDDLE" Grid.Row="1"
              Margin="16,34,16,10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid Grid.Row="0" Margin="0,-31,0,0" Height="160" VerticalAlignment="Top">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" MinWidth="428" />
                    <ColumnDefinition Width="392" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0"
                            Orientation="Horizontal"
                            VerticalAlignment="Top" Height="40" Margin="0,30,0,0" Grid.ColumnSpan="2"
                            HorizontalAlignment="Left" Width="444">
                    <Button Content="Installed Mods"
                            Command="{Binding ShowInstalledModsCommand}"
                            Width="138"
                            FontSize="16"
                            Style="{StaticResource IMM.InstalledTabButtonStyle}" MinHeight="40" />
                    <Button x:Name="ModDatabaseTabButton"
                            Content="Mod DB"
                            Command="{Binding ShowModDatabaseCommand}"
                            Width="138"
                            FontSize="16"
                            Style="{StaticResource IMM.ModDatabaseTabButtonStyle}" Margin="5,0,0,0" MinHeight="40" />
                    <Button x:Name="ModlistsTabButton"
                            Content="Modlists"
                            Command="{Binding ShowCloudModlistsCommand}"
                            Click="ModlistsTabButton_OnClick"
                            Width="138"
                            FontSize="16"
                            Style="{StaticResource IMM.ModlistsTabButtonStyle}" Margin="5,0,0,0" MinHeight="40" />
                </StackPanel>
                <Grid x:Name="ModDB_radiobuttons" Grid.Column="1" Margin="10,0,0,96" Grid.ColumnSpan="2"
                      HorizontalAlignment="Left" Width="617" Height="44" VerticalAlignment="Bottom">
                    <Grid.Style>
                        <Style TargetType="{x:Type Grid}">
                            <Setter Property="Visibility" Value="Collapsed" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding SearchModDatabase}" Value="True">
                                    <Setter Property="Visibility" Value="Visible" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Grid.Style>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Button x:Name="BrowseDownloadsButton"
                            Content="Downloads"
                            Click="BrowseDownloadsButton_OnClick"
                            FontSize="12"
                            FontWeight="Regular"
                            Style="{StaticResource IMM.ModDatabaseDownloadsTabButtonStyle}" Margin="3,-17,542,19"
                            Padding="0,0,0,0" UseLayoutRounding="False"
                            Background="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                    <Button x:Name="BrowseActivityButton"
                            Content="Activity"
                            Click="BrowseActivityButton_OnClick"
                            FontSize="12"
                            FontWeight="Regular"
                            Style="{StaticResource IMM.ModDatabaseActivityTabButtonStyle}" Margin="80,-17,465,19"
                            Padding="0,0,0,0" UseLayoutRounding="False"
                            Background="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                    <Border x:Name="DownloadsBorder" HorizontalAlignment="Right" Grid.RowSpan="2"
                            Visibility="{Binding IsModDatabaseDownloadsTabSelected, Converter={StaticResource IMM.VisibleWhenTrueConverter}}">
                        <Grid>
                            <Rectangle Margin="0,0,379,-4" RadiusX="4" RadiusY="4" StrokeThickness="2"
                                       HorizontalAlignment="Right" Width="235"
                                       Fill="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                            <RadioButton Content="All time"
                                         GroupName="ModDatabaseAutoLoadMode"
                                         IsChecked="{Binding IsTotalDownloadsMode, Mode=TwoWay}" MinWidth="65"
                                         ClickMode="Press"
                                         Margin="0,2,541,20" HorizontalAlignment="Right" Width="65"
                                         VerticalContentAlignment="Center" />
                            <RadioButton Content="Last 30 days"
                                         GroupName="ModDatabaseAutoLoadMode"
                                         IsChecked="{Binding IsDownloadsLastThirtyDaysMode, Mode=TwoWay}" MinWidth="90"
                                         ClickMode="Press" Margin="0,2,426,20" HorizontalAlignment="Right" Width="90"
                                         VerticalContentAlignment="Center" />
                            <RadioButton Content="Last 10 days"
                                         GroupName="ModDatabaseAutoLoadMode"
                                         IsChecked="{Binding IsDownloadsLastTenDaysMode, Mode=TwoWay}" MinWidth="90"
                                         ClickMode="Press" Margin="0,24,516,-2" HorizontalAlignment="Right" Width="90"
                                         VerticalContentAlignment="Center" />
                            <RadioButton Content="Added last 30 days"
                                         GroupName="ModDatabaseAutoLoadMode"
                                         IsChecked="{Binding IsAddedLast30DaysMode, Mode=TwoWay}" MinWidth="90"
                                         ClickMode="Press" Margin="98,24,0,-2" HorizontalAlignment="Left" Width="122"
                                         VerticalContentAlignment="Center" />
                        </Grid>
                    </Border>
                    <Border x:Name="ActivityBorder" HorizontalAlignment="Right" Grid.RowSpan="2"
                            Visibility="{Binding IsModDatabaseActivityTabSelected, Converter={StaticResource IMM.VisibleWhenTrueConverter}}">
                        <Grid>
                            <Rectangle Margin="0,0,379,-4" RadiusX="4" RadiusY="4" StrokeThickness="2"
                                       Fill="{DynamicResource Brush.Button.Primary.Background.Hover}"
                                       HorizontalAlignment="Right" Width="235" />
                            <RadioButton Content="Recently added"
                                         GroupName="ModDatabaseAutoLoadMode"
                                         IsChecked="{Binding IsRecentlyAddedMode, Mode=TwoWay}" MinWidth="115"
                                         ClickMode="Press" HorizontalAlignment="Left" Width="115"
                                         VerticalContentAlignment="Center" Margin="8,2,0,20" />
                            <RadioButton Content="Recently updated"
                                         GroupName="ModDatabaseAutoLoadMode"
                                         IsChecked="{Binding IsRecentlyUpdatedMode, Mode=TwoWay}" MinWidth="120"
                                         ClickMode="Press" Margin="8,24,0,-2" HorizontalAlignment="Left" Width="120"
                                         VerticalContentAlignment="Center" />
                            <RadioButton Content="Most trending"
                                         GroupName="ModDatabaseAutoLoadMode"
                                         IsChecked="{Binding IsMostTrendingMode, Mode=TwoWay}" MinWidth="100"
                                         ClickMode="Press" Margin="126,2,0,20" HorizontalAlignment="Left" Width="100"
                                         VerticalContentAlignment="Center" />
                            <RadioButton Content="Random"
                                         GroupName="ModDatabaseAutoLoadMode"
                                         IsChecked="{Binding IsRandomMode, Mode=TwoWay}" MinWidth="100"
                                         ClickMode="Press" Margin="126,24,0,-2" HorizontalAlignment="Left" Width="100"
                                         VerticalContentAlignment="Center" />

                        </Grid>
                    </Border>

                    <StackPanel Grid.RowSpan="2" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,6,278,0"
                                Height="46" Width="90">
                        <TextBlock Text="Results per page:"
                                   FontSize="11"
                                   Foreground="{DynamicResource Brush.Text.Primary}" />
                        <ComboBox ItemsSource="{Binding ModDatabaseFetchLimitOptions}"
                                  SelectedItem="{Binding SelectedModDatabaseFetchLimit, Mode=TwoWay}"
                                  Width="88"
                                  Height="24"
                                  FontSize="13"
                                  VerticalContentAlignment="Center"
                                  Background="{DynamicResource Brush.ComboBox.Background.Normal}"
                                  BorderBrush="{DynamicResource Brush.ComboBox.Border.Normal}" Padding="6,0,0,0"
                                  HorizontalAlignment="Left" />
                    </StackPanel>
                </Grid>

                <StackPanel Grid.Column="1"
                            Orientation="Horizontal"
                            VerticalAlignment="Top" Height="24" Margin="16,20,230,0">
                    <StackPanel.Style>
                        <Style TargetType="{x:Type StackPanel}">
                            <Setter Property="Visibility" Value="Collapsed" />
                            <Style.Triggers>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding SearchModDatabase}" Value="True" />
                                        <Condition Binding="{Binding SearchText}" Value="" />
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="Visibility" Value="Visible" />
                                </MultiDataTrigger>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding SearchModDatabase}" Value="True" />
                                        <Condition Binding="{Binding SearchText}" Value="{x:Null}" />
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="Visibility" Value="Visible" />
                                </MultiDataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>
                </StackPanel>
                <Grid Grid.Column="2"
                      HorizontalAlignment="Right"
                      VerticalAlignment="Top" Height="64" Width="251">
                    <ToggleButton x:Name="SearchOptionsToggleButton"
                                  Content="Search options"
                                  VerticalAlignment="Top"
                                  Margin="148,-1,1,0" RenderTransformOrigin="0.5,0.5" Height="27" Width="102">
                        <ToggleButton.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform />
                                <SkewTransform AngleY="0.25" />
                                <RotateTransform />
                                <TranslateTransform Y="-0.496" />
                            </TransformGroup>
                        </ToggleButton.RenderTransform>
                        <ToggleButton.Style>
                            <Style TargetType="{x:Type ToggleButton}"
                                   BasedOn="{StaticResource IMM.ToggleButtonBaseStyle}">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SearchModDatabase}" Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding SearchModDatabase}" Value="False">
                                        <Setter Property="IsChecked" Value="False" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ToggleButton.Style>
                    </ToggleButton>
                    <Popup PlacementTarget="{Binding ElementName=SearchOptionsToggleButton}"
                           Placement="Bottom"
                           IsOpen="{Binding IsChecked, ElementName=SearchOptionsToggleButton, Mode=TwoWay}"
                           StaysOpen="False"
                           AllowsTransparency="True"
                           Focusable="False" Margin="0,36,0,33">
                        <Border Background="{DynamicResource Brush.Panel.Primary.Background.Solid}"
                                BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                BorderThickness="1"
                                CornerRadius="6"
                                Padding="12"
                                MinWidth="252">
                            <StackPanel>
                                <CheckBox Content="Include installed mods"
                                          Margin="0,0,0,8"
                                          IsChecked="{Binding IncludeInstalledModDatabaseResults, Mode=TwoWay}" />
                                <CheckBox Content="Only show compatible mods"
                                          IsChecked="{Binding OnlyShowCompatibleModDatabaseResults, Mode=TwoWay}" />
                            </StackPanel>
                        </Border>
                    </Popup>
                    <Grid VerticalAlignment="Center" Height="64" Margin="-253,0,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" MinWidth="229" />
                        </Grid.ColumnDefinitions>

                        <TextBox Grid.Column="1" MinWidth="200"
                                 Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                 FontSize="14" VerticalContentAlignment="Center" Margin="5,28,0,4">

                            <TextBox.Style>
                                <Style TargetType="{x:Type TextBox}" BasedOn="{StaticResource IMM.SearchTextBoxStyle}">
                                    <Setter Property="ui:ControlHelper.PlaceholderText" Value="Search installed mods" />
                                    <Setter Property="Visibility" Value="Visible" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding SearchModDatabase}" Value="True">
                                            <Setter Property="ui:ControlHelper.PlaceholderText"
                                                    Value="Search Mod Database" />
                                            <Setter Property="Visibility" Value="Visible" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding IsViewingCloudModlists}" Value="True">
                                            <Setter Property="IsEnabled" Value="False" />
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Setter Property="ui:ControlHelper.PlaceholderText"
                                                    Value="Cloud modlist search coming soon" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBox.Style>
                        </TextBox>

                        <StackPanel Orientation="Horizontal" Margin="0,28,5,0" VerticalAlignment="Top" Height="32"
                                    HorizontalAlignment="Right">
                            <Button Content="Refresh"
                                    Width="65"
                                    Margin="0,0,10,0"
                                    ToolTip="Quickly refreshes the current view using cached data if no changes are detected on the online mod page."
                                    Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                                    BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                    Command="{Binding RefreshModsUiCommand, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                    MinHeight="32">
                                <Button.Style>
                                    <Style TargetType="{x:Type Button}" BasedOn="{StaticResource {x:Type Button}}">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                        <Setter Property="Padding" Value="6,6,6,6" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsViewingInstalledMods}" Value="True">
                                                <Setter Property="Visibility" Value="Visible" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                            <Button x:Name="RebuildButton"
                                    Content="Rebuild"
                                    Width="65"
                                    ToolTip="Deletes all mod info cache and fetches fresh data online. Slower but ensures everything is reindexed."
                                    Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                                    BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                    Click="RebuildButton_OnClick" MinHeight="32">
                                <Button.Style>
                                    <Style TargetType="{x:Type Button}" BasedOn="{StaticResource {x:Type Button}}">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                        <Setter Property="Padding" Value="6,6,6,6" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsViewingInstalledMods}" Value="True">
                                                <Setter Property="Visibility" Value="Visible" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Grid>
            </Grid>
            <Grid Margin="0,32,25,0" Grid.RowSpan="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <Border x:Name="Installed_and_ModDB" Grid.Row="1"
                        Margin="0,0,-29,0"
                        Background="Transparent"
                        BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Light}"
                        BorderThickness="0,0,2,2"
                        CornerRadius="{Binding Path=(ui:ControlHelper.CornerRadius), ElementName=ModsDataGrid}"
                        SnapsToDevicePixels="True"
                        Visibility="{Binding IsViewingCloudModlists, Converter={StaticResource IMM.VisibleWhenFalseConverter}}"
                        d:IsHidden="True">
                    <Border Background="{DynamicResource Brush.SunkenSurface.Background}"
                            BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Dark}"
                            BorderThickness="2,2,0,0"
                            CornerRadius="{Binding Path=(ui:ControlHelper.CornerRadius), ElementName=ModsDataGrid}"
                            SnapsToDevicePixels="True">
                        <Grid>
                            <DataGrid x:Name="ModsDataGrid"
                                      ItemsSource="{Binding ModsView}"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      IsReadOnly="False"
                                      CanUserSortColumns="True"
                                      EnableRowVirtualization="True"
                                      VirtualizingPanel.IsVirtualizing="True"
                                      VirtualizingPanel.VirtualizationMode="Recycling"
                                      ScrollViewer.CanContentScroll="True"
                                      GridLinesVisibility="None"
                                      SelectionUnit="FullRow"
                                      SelectionMode="Single"

                                      RowHeaderWidth="0"
                                      BorderThickness="0,1,2,1"
                                      IsSynchronizedWithCurrentItem="True"
                                      MinColumnWidth="20"
                                      SelectionChanged="ModsDataGrid_OnSelectionChanged"
                                      Foreground="{DynamicResource Brush.Text.Primary}"
                                      PreviewKeyDown="ModsDataGrid_OnPreviewKeyDown"
                                      PreviewMouseLeftButtonDown="ModsDataGrid_OnPreviewMouseLeftButtonDown"
                                      PreviewMouseWheel="ModsDataGrid_OnPreviewMouseWheel"
                                      Sorting="ModsDataGrid_OnSorting"
                                      RowBackground="{DynamicResource Brush.Button.Primary.Background.Normal}"
                                      HorizontalGridLinesBrush="Transparent"
                                      VerticalGridLinesBrush="Transparent"
                                      HeadersVisibility="Column"
                                      ui:ControlHelper.CornerRadius="0"
                                      FontSize="15"
                                      Background="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                      BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                      Visibility="{Binding IsViewingInstalledMods, Converter={StaticResource IMM.VisibleWhenTrueConverter}}"
                                      IsEnabled="{Binding IsViewingInstalledMods}">
                                <DataGrid.Resources>
                                    <Style TargetType="{x:Type ScrollBar}"
                                           BasedOn="{StaticResource IMM.DataGridScrollBarStyle}" />
                                    <Style TargetType="{x:Type Thumb}"
                                           BasedOn="{StaticResource IMM.DataGridScrollBarThumbStyle}" />
                                    <Style TargetType="{x:Type TextBlock}">
                                        <Setter Property="TextWrapping" Value="Wrap" />
                                    </Style>
                                    <Style TargetType="{x:Type DataGridColumnHeader}"
                                           BasedOn="{StaticResource IMM.PrimaryDataGridColumnHeaderStyle}" />
                                </DataGrid.Resources>
                                <DataGrid.CellStyle>
                                    <StaticResource ResourceKey="IMM.DataGridCellBaseStyle" />
                                </DataGrid.CellStyle>
                                <DataGrid.RowHeaderStyle>

                                    <Style />
                                </DataGrid.RowHeaderStyle>
                                <DataGrid.RowStyle>
                                    <Style TargetType="{x:Type DataGridRow}">
                                        <Setter Property="Background" Value="Transparent" />
                                        <Setter Property="BorderBrush"
                                                Value="{DynamicResource Brush.InstalledMod.Row.Border}" />
                                        <Setter Property="BorderThickness" Value="0" />
                                        <Setter Property="Margin" Value="2,2,2,2" />
                                        <Setter Property="Padding">
                                            <Setter.Value>
                                                <MultiBinding
                                                    Converter="{StaticResource IMM.RowPaddingOffsetConverter}">
                                                    <Binding Source="{StaticResource IMM.RowPaddingBase}" />
                                                    <Binding Source="{StaticResource IMM.NormalRowHeightOffset}" />
                                                </MultiBinding>
                                            </Setter.Value>
                                        </Setter>
                                        <Setter Property="Height" Value="{x:Static sys:Double.NaN}" />
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type DataGridRow}">
                                                    <!-- The brushes here come from InstalledMods_Row_* resources in Resources/Themes. -->
                                                    <Border x:Name="RowBorder"
                                                            Background="{DynamicResource Brush.InstalledMod.Row.Background}"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            CornerRadius="8"
                                                            Margin="4,0,4,4"
                                                            SnapsToDevicePixels="True">
                                                        <Border.Effect>
                                                            <DropShadowEffect
                                                                Color="{Binding Source={StaticResource Brush.DataGrid.RowShadow}, Path=Color}"
                                                                BlurRadius="2" Direction="210" ShadowDepth="2"
                                                                Opacity="0.5" />

                                                        </Border.Effect>
                                                        <Grid>
                                                            <Border x:Name="SelectionOverlay"
                                                                    Background="{DynamicResource Brush.Accent.Primary}"
                                                                    Opacity="0"
                                                                    CornerRadius="8"
                                                                    IsHitTestVisible="False" />
                                                            <Border x:Name="HoverOverlay"
                                                                    Background="{DynamicResource Brush.Button.Primary.Background.Hover}"
                                                                    Opacity="0"
                                                                    CornerRadius="8"
                                                                    IsHitTestVisible="False" />
                                                            <Border Padding="{TemplateBinding Padding}"
                                                                    Background="Transparent"
                                                                    CornerRadius="8">
                                                                <SelectiveScrollingGrid>
                                                                    <SelectiveScrollingGrid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="*" />
                                                                    </SelectiveScrollingGrid.ColumnDefinitions>
                                                                    <SelectiveScrollingGrid.RowDefinitions>
                                                                        <RowDefinition Height="*" />
                                                                        <RowDefinition Height="Auto" />
                                                                    </SelectiveScrollingGrid.RowDefinitions>
                                                                    <DataGridCellsPresenter Grid.Column="0"
                                                                            SelectiveScrollingGrid.SelectiveScrollingOrientation="Both" />
                                                                    <DataGridDetailsPresenter Grid.Column="0"
                                                                            Grid.Row="1"
                                                                            SelectiveScrollingGrid.SelectiveScrollingOrientation="Horizontal"
                                                                            Visibility="{TemplateBinding DetailsVisibility}" />
                                                                </SelectiveScrollingGrid>
                                                            </Border>
                                                        </Grid>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <DataTrigger Binding="{Binding HasErrors}" Value="True">
                                                            <Setter TargetName="RowBorder" Property="Background"
                                                                    Value="{DynamicResource Brush.Overlay.Warning.Background}" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding HasActivationError}"
                                                                     Value="True">
                                                            <Setter TargetName="RowBorder" Property="Background"
                                                                    Value="{DynamicResource Brush.Overlay.Warning.Background}" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding IsActive}" Value="False">
                                                            <Setter TargetName="RowBorder" Property="Background"
                                                                    Value="{DynamicResource Brush.ModCard.Background.Disabled}" />
                                                            <Setter TargetName="RowBorder" Property="Opacity"
                                                                    Value="0.5" />
                                                        </DataTrigger>
                                                        <Trigger Property="DetailsVisibility" Value="Visible">
                                                            <Setter TargetName="RowBorder" Property="BorderThickness"
                                                                    Value="2,2,2,2" />
                                                        </Trigger>
                                                        <MultiTrigger>
                                                            <MultiTrigger.Conditions>
                                                                <Condition Property="IsMouseOver" Value="True" />
                                                                <Condition Property="IsSelected" Value="False" />
                                                            </MultiTrigger.Conditions>
                                                            <Setter TargetName="RowBorder" Property="BorderBrush"
                                                                    Value="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                                                        </MultiTrigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <EventSetter Event="UIElement.PreviewMouseLeftButtonDown"
                                                     Handler="ModsDataGridRow_OnPreviewMouseLeftButtonDown" />
                                        <EventSetter Event="FrameworkElement.Loaded" Handler="ModsDataGridRow_OnLoaded" />
                                        <EventSetter Event="FrameworkElement.Unloaded"
                                                     Handler="ModsDataGridRow_OnUnloaded" />
                                        <EventSetter Event="UIElement.MouseEnter"
                                                     Handler="ModsDataGridRow_OnMouseEnter" />
                                        <EventSetter Event="UIElement.MouseLeave"
                                                     Handler="ModsDataGridRow_OnMouseLeave" />
                                        <Style.Triggers>
                                            <DataTrigger
                                                Binding="{Binding DataContext.IsCompactView, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                Value="True">
                                                <Setter Property="Padding">
                                                    <Setter.Value>
                                                        <MultiBinding
                                                            Converter="{StaticResource IMM.RowPaddingOffsetConverter}">
                                                            <Binding Source="{StaticResource IMM.RowPaddingBase}" />
                                                            <Binding
                                                                Source="{StaticResource IMM.CompactRowHeightOffset}" />
                                                        </MultiBinding>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding HasErrors}" Value="True">
                                                <Setter Property="Background"
                                                        Value="{DynamicResource Brush.Overlay.Warning.Background}" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding HasActivationError}" Value="True">
                                                <Setter Property="Background"
                                                        Value="{DynamicResource Brush.Overlay.Warning.Background}" />
                                            </DataTrigger>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background"
                                                        Value="{DynamicResource Brush.DataGrid.Row.Background.Selected}" />
                                                <Setter Property="BorderBrush"
                                                        Value="{DynamicResource Brush.Accent.Primary}" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.RowStyle>
                                <DataGrid.Columns>
                                    <DataGridTemplateColumn x:Name="ActiveColumn" Header="Active"
                                                            SortMemberPath="ActiveSortOrder" Width="90" MinWidth="85">
                                        <DataGridTemplateColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                                <Setter Property="Padding" Value="0" />
                                            </Style>
                                        </DataGridTemplateColumn.CellStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Grid HorizontalAlignment="Center">
                                                    <ui:ToggleSwitch
                                                        IsOn="{Binding IsActive, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                        HorizontalAlignment="Center"
                                                        Toggled="ActiveToggle_OnToggled"
                                                        PreviewMouseLeftButtonDown="ActiveToggle_OnPreviewMouseLeftButtonDown"
                                                        PreviewMouseLeftButtonUp="ActiveToggle_OnPreviewMouseLeftButtonUp"
                                                        PreviewMouseMove="ActiveToggle_OnPreviewMouseMove"
                                                        Margin="12,0"
                                                        OnContent="{x:Null}"
                                                        OffContent="{x:Null}">
                                                        <ui:ToggleSwitch.Style>
                                                            <Style TargetType="{x:Type ui:ToggleSwitch}"
                                                                   BasedOn="{StaticResource IMM.ToggleSwitchBaseStyle}">
                                                                <Setter Property="IsEnabled"
                                                                        Value="{Binding CanToggle}" />
                                                            </Style>
                                                        </ui:ToggleSwitch.Style>
                                                    </ui:ToggleSwitch>
                                                </Grid>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn x:Name="IconColumn" Header="Icon" Width="76"
                                                            IsReadOnly="True">
                                        <DataGridTemplateColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Left" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                                <Setter Property="Padding" Value="0,0,12,0" />
                                            </Style>
                                        </DataGridTemplateColumn.CellStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Border Width="64" Height="64"
                                                        HorizontalAlignment="Left"
                                                        VerticalAlignment="Center"
                                                        ToolTipService.ShowDuration="60000"
                                                        ToolTipService.InitialShowDelay="200">
                                                    <ToolTipService.ToolTip>
                                                        <TextBlock Text="{Binding Tooltip}"
                                                                   FontFamily="Segoe UI"
                                                                   FontSize="12"
                                                                   FontWeight="Normal"
                                                                   MaxWidth="300"
                                                                   Foreground="{DynamicResource Brush.ToolTip.Text}"
                                                                   TextWrapping="Wrap" />
                                                    </ToolTipService.ToolTip>
                                                    <Image Source="{Binding Icon}" Stretch="Uniform" Margin="0" />
                                                </Border>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn x:Name="NameColumn" Header="Name"
                                                        Binding="{Binding DisplayName, Mode=OneWay}" Width="220"
                                                        SortMemberPath="NameSortKey" IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="FontFamily" Value="Segoe UI" />
                                                <Setter Property="FontWeight" Value="Bold" />
                                                <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                <Setter Property="ToolTipService.InitialShowDelay" Value="200" />
                                                <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                <Setter Property="VerticalAlignment" Value="Center" />
                                                <Setter Property="TextAlignment" Value="Left" />
                                                <Setter Property="Margin" Value="15,0,0,0" />
                                                <Setter Property="ToolTipService.ToolTip">
                                                    <Setter.Value>
                                                        <TextBlock Text="{Binding Tooltip}"
                                                                   FontFamily="Segoe UI"
                                                                   FontSize="12"
                                                                   FontWeight="Normal"
                                                                   MaxWidth="300"
                                                                   Foreground="{DynamicResource Brush.ToolTip.Text}"
                                                                   TextWrapping="Wrap" />
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.CellStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn x:Name="VersionColumn"
                                                        Header="Version"
                                                        Binding="{Binding VersionDisplay, Mode=OneWay}"
                                                        Width="85"
                                                        IsReadOnly="True"
                                                        MinWidth="80">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="HorizontalAlignment" Value="Center" />
                                                <Setter Property="VerticalAlignment" Value="Center" />
                                                <Setter Property="TextAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.CellStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn x:Name="LatestVersionColumn" Header="Latest Version"
                                                        Binding="{Binding LatestDatabaseVersionDisplay, Mode=OneWay}"
                                                        SortMemberPath="LatestVersionSortKey" Width="140"
                                                        MinWidth="139" IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="HorizontalAlignment" Value="Center" />
                                                <Setter Property="VerticalAlignment" Value="Center" />
                                                <Setter Property="Padding" Value="4,2" />
                                                <Setter Property="Margin" Value="2" />
                                                <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                <Setter Property="ToolTip">
                                                    <Setter.Value>
                                                        <ToolTip MaxHeight="600"
                                                                 MaxWidth="300"
                                                                 Padding="0">
                                                            <Border MaxHeight="600"
                                                                    MaxWidth="300"
                                                                    ClipToBounds="True">
                                                                <ItemsControl
                                                                    ItemsSource="{Binding NewerReleaseChangelogs}">
                                                                    <ItemsControl.ItemTemplate>
                                                                        <DataTemplate>
                                                                            <StackPanel Margin="0,0,0,12"
                                                                                    MaxWidth="300">
                                                                                <TextBlock Text="{Binding Version}"
                                                                                    FontWeight="Bold"
                                                                                    Margin="0,0,0,4"
                                                                                    Foreground="{DynamicResource Brush.ToolTip.Text}" />
                                                                                <TextBlock Text="{Binding Changelog}"
                                                                                    TextWrapping="Wrap"
                                                                                    Foreground="{DynamicResource Brush.ToolTip.Text}"
                                                                                    MaxWidth="300" />
                                                                            </StackPanel>
                                                                        </DataTemplate>
                                                                    </ItemsControl.ItemTemplate>
                                                                </ItemsControl>
                                                            </Border>
                                                        </ToolTip>
                                                    </Setter.Value>
                                                </Setter>
                                                <EventSetter Event="FrameworkElement.ToolTipOpening"
                                                             Handler="LatestVersionTextBlock_OnToolTipOpening" />
                                                <EventSetter Event="FrameworkElement.ToolTipClosing"
                                                             Handler="LatestVersionTextBlock_OnToolTipClosing" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ShouldHighlightLatestVersion}"
                                                                 Value="True">
                                                        <Setter Property="Background"
                                                                Value="{DynamicResource Brush.Accent.Primary}" />
                                                        <Setter Property="Foreground"
                                                                Value="{DynamicResource Brush.Text.Primary}" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding HasNewerReleaseChangelogs}"
                                                                 Value="False">
                                                        <Setter Property="ToolTip" Value="{x:Null}" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.CellStyle>
                                    </DataGridTextColumn>


                                    <DataGridTextColumn x:Name="AuthorsColumn" Header="Authors"
                                                        Binding="{Binding AuthorsDisplay, Mode=OneWay}" Width="150"
                                                        IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="TextWrapping" Value="NoWrap" />
                                                <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                                                <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                <Setter Property="VerticalAlignment" Value="Center" />
                                                <Setter Property="TextAlignment" Value="Center" />
                                                <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                <Setter Property="ToolTipService.InitialShowDelay" Value="200" />
                                                <Setter Property="ToolTipService.ToolTip">
                                                    <Setter.Value>
                                                        <TextBlock Text="{Binding AuthorsDisplay}"
                                                                   FontFamily="Segoe UI"
                                                                   FontSize="12"
                                                                   Foreground="{DynamicResource Brush.ToolTip.Text}"
                                                                   TextWrapping="Wrap"
                                                                   MaxWidth="300" />
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.CellStyle>
                                    </DataGridTextColumn>
                                    <DataGridTemplateColumn x:Name="TagsColumn"
                                                            Header="Tags"
                                                            Width="280"
                                                            MinWidth="180"
                                                            IsReadOnly="True"
                                                            CanUserSort="False">
                                        <DataGridTemplateColumn.HeaderTemplate>
                                            <DataTemplate>
                                                <Grid Background="Transparent"
                                                      Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType={x:Type DataGridColumnHeader}}}">
                                                    <ToggleButton x:Name="TagsHeaderToggle"
                                                                  Content="{Binding DataContext.TagsColumnHeader, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                                  Style="{StaticResource IMM.TagHeaderToggleButtonStyle}" />
                                                    <Popup PlacementTarget="{Binding ElementName=TagsHeaderToggle}"
                                                           Placement="Bottom"
                                                           IsOpen="{Binding IsChecked, ElementName=TagsHeaderToggle, Mode=TwoWay}"
                                                           StaysOpen="False"
                                                           AllowsTransparency="True"
                                                           Focusable="False">
                                                        <Border
                                                            Background="{DynamicResource Brush.Panel.Primary.Background.Solid}"
                                                            BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                                            BorderThickness="1"
                                                            CornerRadius="6"
                                                            Padding="8"
                                                            MinWidth="440">
                                                            <ScrollViewer MaxHeight="260"
                                                                          HorizontalScrollBarVisibility="Disabled"
                                                                          VerticalScrollBarVisibility="Auto">
                                                                <ScrollViewer.Resources>
                                                                    <Style TargetType="{x:Type ScrollBar}"
                                                                           BasedOn="{StaticResource IMM.DataGridScrollBarStyle}" />
                                                                    <Style TargetType="{x:Type Thumb}"
                                                                           BasedOn="{StaticResource IMM.DataGridScrollBarThumbStyle}" />
                                                                </ScrollViewer.Resources>
                                                                <ItemsControl
                                                                    ItemsPanel="{StaticResource IMM.TagFilterItemsPanelTemplate}"
                                                                    ItemsSource="{Binding DataContext.InstalledTagFilters, RelativeSource={RelativeSource AncestorType={x:Type Window}}}">
                                                                    <ItemsControl.ItemTemplate>
                                                                        <DataTemplate
                                                                            DataType="{x:Type viewModels:TagFilterOptionViewModel}">
                                                                            <ToggleButton
                                                                                Style="{StaticResource IMM.TagFilterToggleButtonStyle}"
                                                                                Content="{Binding Name}"
                                                                                IsChecked="{Binding IsSelected, Mode=TwoWay}" />
                                                                        </DataTemplate>
                                                                    </ItemsControl.ItemTemplate>
                                                                </ItemsControl>
                                                            </ScrollViewer>
                                                        </Border>
                                                    </Popup>
                                                </Grid>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.HeaderTemplate>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <Border x:Name="TagsContainer"
                                                            HorizontalAlignment="Stretch"
                                                            VerticalAlignment="Center"
                                                            MaxHeight="{StaticResource IMM.TagRowMaxHeight}"
                                                            ClipToBounds="True">
                                                        <ItemsControl x:Name="TagsItemsControl"
                                                                      Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType={x:Type DataGridCell}}}"
                                                                      HorizontalAlignment="Left"
                                                                      ItemsSource="{Binding DatabaseTags}"
                                                                      ItemTemplate="{StaticResource IMM.TagBadgeTemplate}"
                                                                      ItemsPanel="{StaticResource IMM.TagItemsPanelTemplate}" />
                                                    </Border>
                                                    <TextBlock x:Name="NoTagsText"
                                                               Text="â€”"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"
                                                               Visibility="Collapsed" />
                                                </Grid>
                                                <DataTemplate.Triggers>
                                                    <DataTrigger Binding="{Binding DatabaseTags.Count}" Value="0">
                                                        <Setter TargetName="TagsContainer" Property="Visibility"
                                                                Value="Collapsed" />
                                                        <Setter TargetName="NoTagsText" Property="Visibility"
                                                                Value="Visible" />
                                                    </DataTrigger>
                                                    <DataTrigger
                                                        Binding="{Binding DataContext.IsCompactView, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                        Value="True">
                                                        <Setter TargetName="TagsContainer" Property="MaxHeight"
                                                                Value="{StaticResource IMM.TagRowCompactMaxHeight}" />
                                                    </DataTrigger>
                                                </DataTemplate.Triggers>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                        <DataGridTemplateColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTemplateColumn.CellStyle>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn x:Name="StatusColumn" Header="Status" Width="80"
                                                            IsReadOnly="True" SortMemberPath="StatusSortOrder">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Grid HorizontalAlignment="Center"
                                                      VerticalAlignment="Center">
                                                    <Viewbox x:Name="StatusIconViewbox"
                                                             Width="32"
                                                             Height="32">
                                                        <Grid Width="32"
                                                              Height="32">
                                                            <Image x:Name="ErrorIcon"
                                                                   Width="32"
                                                                   Height="32"
                                                                   Stretch="Uniform"
                                                                   Source="/error.png"
                                                                   Visibility="Collapsed" />
                                                            <Image x:Name="WarningIcon"
                                                                   Width="32"
                                                                   Height="32"
                                                                   Stretch="Uniform"
                                                                   Source="/warning.png"
                                                                   Visibility="Collapsed" />
                                                        </Grid>
                                                    </Viewbox>
                                                </Grid>
                                                <DataTemplate.Triggers>
                                                    <DataTrigger
                                                        Binding="{Binding DataContext.IsCompactView, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                        Value="True">
                                                        <Setter TargetName="StatusIconViewbox" Property="Width"
                                                                Value="22.5" />
                                                        <Setter TargetName="StatusIconViewbox" Property="Height"
                                                                Value="22.5" />
                                                        <Setter TargetName="ErrorIcon" Property="Width" Value="22.5" />
                                                        <Setter TargetName="ErrorIcon" Property="Height" Value="22.5" />
                                                        <Setter TargetName="WarningIcon" Property="Width" Value="22.5" />
                                                        <Setter TargetName="WarningIcon" Property="Height" Value="22.5" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding StatusText}" Value="Error">
                                                        <Setter TargetName="ErrorIcon" Property="Visibility"
                                                                Value="Visible" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding StatusText}" Value="Warning">
                                                        <Setter TargetName="WarningIcon" Property="Visibility"
                                                                Value="Visible" />
                                                    </DataTrigger>
                                                </DataTemplate.Triggers>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                        <DataGridTemplateColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="ToolTip" Value="{Binding StatusDetails}" />
                                            </Style>
                                        </DataGridTemplateColumn.CellStyle>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn x:Name="UserReportsColumn" Header="User Reports"
                                                            Width="150" IsReadOnly="True">
                                        <DataGridTemplateColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTemplateColumn.CellStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button
                                                    Content="{Binding UserReportDisplay}"
                                                    ToolTip="{Binding UserReportTooltip}"
                                                    Click="UserReportsButton_OnClick"
                                                    IsEnabled="{Binding CanSubmitUserReport}"
                                                    HorizontalAlignment="Stretch" ClipToBounds="True">
                                                    <Button.Style>
                                                        <Style TargetType="{x:Type Button}"
                                                               BasedOn="{StaticResource IMM.UserReportButtonStyle}">
                                                            <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                            <Setter Property="Padding" Value="4,0" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding IsUserReportLoading}"
                                                                             Value="True">
                                                                    <Setter Property="Cursor" Value="Wait" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding UserReportHasError}"
                                                                             Value="True">
                                                                    <Setter Property="Foreground"
                                                                            Value="{DynamicResource Brush.Text.Emphasis}" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn x:Name="SideColumn" Header="Side"
                                                        Binding="{Binding SideDisplay, Mode=OneWay}"
                                                        SortMemberPath="SideSortValue"
                                                        Width="90"
                                                        MinWidth="80"
                                                        IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="HorizontalAlignment" Value="Center" />
                                                <Setter Property="VerticalAlignment" Value="Center" />
                                                <Setter Property="TextAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.CellStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <DataGrid x:Name="ModDbDataGrid"
                                      ItemsSource="{Binding SearchResultsView}"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      IsReadOnly="False"
                                      EnableRowVirtualization="True"
                                      VirtualizingPanel.IsVirtualizing="True"
                                      VirtualizingPanel.VirtualizationMode="Recycling"
                                      ScrollViewer.CanContentScroll="True"
                                      GridLinesVisibility="None"
                                      SelectionUnit="FullRow"
                                      SelectionMode="Single"

                                      RowHeaderWidth="0"
                                      BorderThickness="0,1,2,1"
                                      IsSynchronizedWithCurrentItem="True"
                                      MinColumnWidth="20"
                                      SelectionChanged="ModsDataGrid_OnSelectionChanged"
                                      Foreground="{DynamicResource Brush.Text.Primary}"
                                      PreviewKeyDown="ModsDataGrid_OnPreviewKeyDown"
                                      PreviewMouseLeftButtonDown="ModsDataGrid_OnPreviewMouseLeftButtonDown"
                                      PreviewMouseWheel="ModsDataGrid_OnPreviewMouseWheel"
                                      Sorting="ModsDataGrid_OnSorting"
                                      RowBackground="{DynamicResource Brush.Button.Primary.Background.Normal}"
                                      HorizontalGridLinesBrush="Transparent"
                                      VerticalGridLinesBrush="Transparent"
                                      HeadersVisibility="Column"
                                      ui:ControlHelper.CornerRadius="0"
                                      FontSize="15"
                                      Background="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                      BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}">
                                <DataGrid.Resources>
                                    <Style TargetType="{x:Type ScrollBar}"
                                           BasedOn="{StaticResource IMM.DataGridScrollBarStyle}" />
                                    <Style TargetType="{x:Type Thumb}"
                                           BasedOn="{StaticResource IMM.DataGridScrollBarThumbStyle}" />
                                    <Style TargetType="{x:Type TextBlock}">
                                        <Setter Property="TextWrapping" Value="Wrap" />
                                    </Style>
                                    <Style TargetType="{x:Type DataGridColumnHeader}"
                                           BasedOn="{StaticResource IMM.PrimaryDataGridColumnHeaderStyle}" />
                                </DataGrid.Resources>
                                <DataGrid.CellStyle>
                                    <StaticResource ResourceKey="IMM.DataGridCellBaseStyle" />
                                </DataGrid.CellStyle>
                                <DataGrid.Style>
                                    <Style TargetType="{x:Type DataGrid}">
                                        <Setter Property="CanUserSortColumns" Value="True" />
                                        <Setter Property="IsEnabled" Value="False" />
                                        <Setter Property="Visibility" Value="Collapsed" />

                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SearchModDatabase}" Value="True">
                                                <Setter Property="CanUserSortColumns" Value="False" />
                                                <Setter Property="Visibility" Value="Visible" />
                                                <Setter Property="IsEnabled" Value="True" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding IsViewingCloudModlists}" Value="True">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Setter Property="IsEnabled" Value="False" />
                                            </DataTrigger>
                                            <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                    <Condition Binding="{Binding SearchModDatabase}" Value="True" />
                                                    <Condition Binding="{Binding UseModDbDesignView}" Value="True" />
                                                </MultiDataTrigger.Conditions>
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Setter Property="IsEnabled" Value="False" />
                                            </MultiDataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.Style>

                                <DataGrid.RowHeaderStyle>

                                    <Style />
                                </DataGrid.RowHeaderStyle>
                                <DataGrid.RowStyle>
                                    <Style TargetType="{x:Type DataGridRow}">
                                        <Setter Property="Background" Value="Transparent" />
                                        <Setter Property="BorderBrush"
                                                Value="{DynamicResource Brush.InstalledMod.Row.Border}" />
                                        <Setter Property="BorderThickness" Value="0" />
                                        <Setter Property="Margin" Value="2,2,2,2" />
                                        <Setter Property="Padding">
                                            <Setter.Value>
                                                <MultiBinding
                                                    Converter="{StaticResource IMM.RowPaddingOffsetConverter}">
                                                    <Binding Source="{StaticResource IMM.RowPaddingBase}" />
                                                    <Binding Source="{StaticResource IMM.NormalRowHeightOffset}" />
                                                </MultiBinding>
                                            </Setter.Value>
                                        </Setter>
                                        <Setter Property="Height" Value="{x:Static sys:Double.NaN}" />
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type DataGridRow}">
                                                    <!-- The brushes here come from InstalledMods_Row_* resources in Resources/Themes. -->
                                                    <Border x:Name="RowBorder"
                                                            Background="{DynamicResource Brush.InstalledMod.Row.Background}"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            CornerRadius="8"
                                                            Margin="4,0,4,4"
                                                            SnapsToDevicePixels="True">
                                                        <Border.Effect>
                                                            <DropShadowEffect
                                                                Color="{Binding Source={StaticResource Brush.DataGrid.RowShadow}, Path=Color}"
                                                                BlurRadius="2" Direction="210" ShadowDepth="2"
                                                                Opacity="0.5" />

                                                        </Border.Effect>
                                                        <Grid>
                                                            <Border x:Name="SelectionOverlay"
                                                                    Background="{DynamicResource Brush.Accent.Primary}"
                                                                    Opacity="0"
                                                                    CornerRadius="8"
                                                                    IsHitTestVisible="False" />
                                                            <Border x:Name="HoverOverlay"
                                                                    Background="{DynamicResource Brush.Button.Primary.Background.Hover}"
                                                                    Opacity="0"
                                                                    CornerRadius="8"
                                                                    IsHitTestVisible="False" />
                                                            <Border Padding="{TemplateBinding Padding}"
                                                                    Background="Transparent"
                                                                    CornerRadius="8">
                                                                <SelectiveScrollingGrid>
                                                                    <SelectiveScrollingGrid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="*" />
                                                                    </SelectiveScrollingGrid.ColumnDefinitions>
                                                                    <SelectiveScrollingGrid.RowDefinitions>
                                                                        <RowDefinition Height="*" />
                                                                        <RowDefinition Height="Auto" />
                                                                    </SelectiveScrollingGrid.RowDefinitions>
                                                                    <DataGridCellsPresenter Grid.Column="0"
                                                                            SelectiveScrollingGrid.SelectiveScrollingOrientation="Both" />
                                                                    <DataGridDetailsPresenter Grid.Column="0"
                                                                            Grid.Row="1"
                                                                            SelectiveScrollingGrid.SelectiveScrollingOrientation="Horizontal"
                                                                            Visibility="{TemplateBinding DetailsVisibility}" />
                                                                </SelectiveScrollingGrid>
                                                            </Border>
                                                        </Grid>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <DataTrigger Binding="{Binding HasErrors}" Value="True">
                                                            <Setter TargetName="RowBorder" Property="Background"
                                                                    Value="{DynamicResource Brush.Overlay.Warning.Background}" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding HasActivationError}"
                                                                     Value="True">
                                                            <Setter TargetName="RowBorder" Property="Background"
                                                                    Value="{DynamicResource Brush.Overlay.Warning.Background}" />
                                                        </DataTrigger>
                                                        <Trigger Property="DetailsVisibility" Value="Visible">
                                                            <Setter TargetName="RowBorder" Property="BorderThickness"
                                                                    Value="2,2,2,2" />
                                                        </Trigger>
                                                        <MultiTrigger>
                                                            <MultiTrigger.Conditions>
                                                                <Condition Property="IsMouseOver" Value="True" />
                                                                <Condition Property="IsSelected" Value="False" />
                                                            </MultiTrigger.Conditions>
                                                            <Setter TargetName="RowBorder" Property="BorderBrush"
                                                                    Value="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                                                        </MultiTrigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <EventSetter Event="UIElement.PreviewMouseLeftButtonDown"
                                                     Handler="ModsDataGridRow_OnPreviewMouseLeftButtonDown" />
                                        <EventSetter Event="FrameworkElement.Loaded" Handler="ModsDataGridRow_OnLoaded" />
                                        <EventSetter Event="FrameworkElement.Unloaded"
                                                     Handler="ModsDataGridRow_OnUnloaded" />
                                        <EventSetter Event="UIElement.MouseEnter"
                                                     Handler="ModsDataGridRow_OnMouseEnter" />
                                        <EventSetter Event="UIElement.MouseLeave"
                                                     Handler="ModsDataGridRow_OnMouseLeave" />
                                        <Style.Triggers>
                                            <DataTrigger
                                                Binding="{Binding DataContext.IsCompactView, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                Value="True">
                                                <Setter Property="Padding">
                                                    <Setter.Value>
                                                        <MultiBinding
                                                            Converter="{StaticResource IMM.RowPaddingOffsetConverter}">
                                                            <Binding Source="{StaticResource IMM.RowPaddingBase}" />
                                                            <Binding
                                                                Source="{StaticResource IMM.CompactRowHeightOffset}" />
                                                        </MultiBinding>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding HasErrors}" Value="True">
                                                <Setter Property="Background"
                                                        Value="{DynamicResource Brush.Overlay.Warning.Background}" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding HasActivationError}" Value="True">
                                                <Setter Property="Background"
                                                        Value="{DynamicResource Brush.Overlay.Warning.Background}" />
                                            </DataTrigger>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background"
                                                        Value="{DynamicResource Brush.DataGrid.Row.Background.Selected}" />
                                                <Setter Property="BorderBrush"
                                                        Value="{DynamicResource Brush.Accent.Primary}" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.RowStyle>
                                <DataGrid.Columns>
                                    <DataGridTextColumn x:Name="ModDbNameColumn" Header="Name"
                                                        Binding="{Binding DisplayName, Mode=OneWay}" Width="220"
                                                        SortMemberPath="NameSortKey" IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="FontFamily" Value="Segoe UI" />
                                                <Setter Property="FontWeight" Value="Bold" />
                                                <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                <Setter Property="ToolTipService.InitialShowDelay" Value="200" />
                                                <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                <Setter Property="VerticalAlignment" Value="Center" />
                                                <Setter Property="TextAlignment" Value="Left" />
                                                <Setter Property="Margin" Value="15,0,0,0" />
                                                <Setter Property="ToolTipService.ToolTip">
                                                    <Setter.Value>
                                                        <TextBlock Text="{Binding Tooltip}"
                                                                   FontFamily="Segoe UI"
                                                                   FontSize="12"
                                                                   FontWeight="Normal"
                                                                   MaxWidth="300"
                                                                   Foreground="{DynamicResource Brush.ToolTip.Text}"
                                                                   TextWrapping="Wrap" />
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.CellStyle>
                                    </DataGridTextColumn>
                                    <DataGridTemplateColumn x:Name="ModDbInstalledColumn" Header="Installed" Width="85"
                                                            IsReadOnly="True">
                                        <DataGridTemplateColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTemplateColumn.CellStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="âœ“"
                                                           Foreground="{DynamicResource Brush.Accent.Primary}"
                                                           FontSize="16"
                                                           FontWeight="Bold"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center">
                                                    <TextBlock.Style>
                                                        <Style TargetType="{x:Type TextBlock}">
                                                            <Setter Property="Visibility" Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding IsInstalled}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility" Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn x:Name="ModDbLatestVersionColumn" Header="Latest Version"
                                                        Binding="{Binding LatestDatabaseVersionDisplay, Mode=OneWay}"
                                                        SortMemberPath="LatestVersionSortKey" Width="140"
                                                        MinWidth="139" IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="HorizontalAlignment" Value="Center" />
                                                <Setter Property="VerticalAlignment" Value="Center" />
                                                <Setter Property="Padding" Value="4,2" />
                                                <Setter Property="Margin" Value="2" />
                                                <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                <Setter Property="ToolTip">
                                                    <Setter.Value>
                                                        <ToolTip MaxHeight="600"
                                                                 MaxWidth="300"
                                                                 Padding="0">
                                                            <Border MaxHeight="600"
                                                                    MaxWidth="300"
                                                                    ClipToBounds="True">
                                                                <ItemsControl
                                                                    ItemsSource="{Binding NewerReleaseChangelogs}">
                                                                    <ItemsControl.ItemTemplate>
                                                                        <DataTemplate>
                                                                            <StackPanel Margin="0,0,0,12"
                                                                                    MaxWidth="300">
                                                                                <TextBlock Text="{Binding Version}"
                                                                                    FontWeight="Bold"
                                                                                    Margin="0,0,0,4"
                                                                                    Foreground="{DynamicResource Brush.ToolTip.Text}" />
                                                                                <TextBlock Text="{Binding Changelog}"
                                                                                    TextWrapping="Wrap"
                                                                                    Foreground="{DynamicResource Brush.ToolTip.Text}"
                                                                                    MaxWidth="300" />
                                                                            </StackPanel>
                                                                        </DataTemplate>
                                                                    </ItemsControl.ItemTemplate>
                                                                </ItemsControl>
                                                            </Border>
                                                        </ToolTip>
                                                    </Setter.Value>
                                                </Setter>
                                                <EventSetter Event="FrameworkElement.ToolTipOpening"
                                                             Handler="LatestVersionTextBlock_OnToolTipOpening" />
                                                <EventSetter Event="FrameworkElement.ToolTipClosing"
                                                             Handler="LatestVersionTextBlock_OnToolTipClosing" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ShouldHighlightLatestVersion}"
                                                                 Value="True">
                                                        <Setter Property="Foreground"
                                                                Value="{DynamicResource Brush.Text.Primary}" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding HasNewerReleaseChangelogs}"
                                                                 Value="False">
                                                        <Setter Property="ToolTip" Value="{x:Null}" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.CellStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn x:Name="ModDbDownloadsColumn"
                                                        Width="120"
                                                        MinWidth="110"
                                                        IsReadOnly="True">
                                        <DataGridTextColumn.Header>
                                            <TextBlock Text="Downloads" />
                                        </DataGridTextColumn.Header>
                                        <DataGridTextColumn.Binding>
                                            <MultiBinding
                                                Converter="{StaticResource IMM.DownloadMetricDisplayConverter}">
                                                <Binding Path="DataContext.IsShowingRecentDownloadMetric"
                                                         RelativeSource="{RelativeSource AncestorType=DataGrid}" />
                                                <Binding Path="DownloadsDisplay" />
                                                <Binding Path="RecentDownloadsDisplay" />
                                                <Binding Path="TenDayDownloadsDisplay" />
                                                <Binding Path="DataContext.ModDatabaseAutoLoadMode"
                                                         RelativeSource="{RelativeSource AncestorType=DataGrid}" />
                                            </MultiBinding>
                                        </DataGridTextColumn.Binding>
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="HorizontalAlignment" Value="Center" />
                                                <Setter Property="VerticalAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.CellStyle>
                                    </DataGridTextColumn>


                                    <DataGridTextColumn x:Name="ModDbAuthorsColumn" Header="Authors"
                                                        Binding="{Binding AuthorsDisplay, Mode=OneWay}" Width="150"
                                                        IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="TextWrapping" Value="NoWrap" />
                                                <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                                                <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                <Setter Property="VerticalAlignment" Value="Center" />
                                                <Setter Property="TextAlignment" Value="Center" />
                                                <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                <Setter Property="ToolTipService.InitialShowDelay" Value="200" />
                                                <Setter Property="ToolTipService.ToolTip">
                                                    <Setter.Value>
                                                        <TextBlock Text="{Binding AuthorsDisplay}"
                                                                   FontFamily="Segoe UI"
                                                                   FontSize="12"
                                                                   Foreground="{DynamicResource Brush.ToolTip.Text}"
                                                                   TextWrapping="Wrap"
                                                                   MaxWidth="300" />
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.CellStyle>
                                    </DataGridTextColumn>
                                    <DataGridTemplateColumn x:Name="ModDbTagsColumn"
                                                            Header="Tags"
                                                            Width="280"
                                                            MinWidth="180"
                                                            IsReadOnly="True"
                                                            CanUserSort="False">
                                        <DataGridTemplateColumn.HeaderTemplate>
                                            <DataTemplate>
                                                <Grid Background="Transparent"
                                                      Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType={x:Type DataGridColumnHeader}}}">
                                                    <ToggleButton x:Name="TagsHeaderToggle"
                                                                  Content="{Binding DataContext.TagsColumnHeader, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                                  Style="{StaticResource IMM.TagHeaderToggleButtonStyle}" />
                                                    <Popup PlacementTarget="{Binding ElementName=TagsHeaderToggle}"
                                                           Placement="Bottom"
                                                           IsOpen="{Binding IsChecked, ElementName=TagsHeaderToggle, Mode=TwoWay}"
                                                           StaysOpen="False"
                                                           AllowsTransparency="True"
                                                           Focusable="False">
                                                        <Border
                                                            Background="{DynamicResource Brush.Panel.Primary.Background.Solid}"
                                                            BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                                            BorderThickness="1"
                                                            CornerRadius="6"
                                                            Padding="8"
                                                            MinWidth="440">
                                                            <ScrollViewer MaxHeight="260"
                                                                          HorizontalScrollBarVisibility="Disabled"
                                                                          VerticalScrollBarVisibility="Auto">
                                                                <ScrollViewer.Resources>
                                                                    <Style TargetType="{x:Type ScrollBar}"
                                                                           BasedOn="{StaticResource IMM.DataGridScrollBarStyle}" />
                                                                    <Style TargetType="{x:Type Thumb}"
                                                                           BasedOn="{StaticResource IMM.DataGridScrollBarThumbStyle}" />
                                                                </ScrollViewer.Resources>
                                                                <ItemsControl
                                                                    ItemsPanel="{StaticResource IMM.TagFilterItemsPanelTemplate}"
                                                                    ItemsSource="{Binding DataContext.ModDatabaseTagFilters, RelativeSource={RelativeSource AncestorType={x:Type Window}}}">
                                                                    <ItemsControl.ItemTemplate>
                                                                        <DataTemplate
                                                                            DataType="{x:Type viewModels:TagFilterOptionViewModel}">
                                                                            <ToggleButton
                                                                                Style="{StaticResource IMM.TagFilterToggleButtonStyle}"
                                                                                Content="{Binding Name}"
                                                                                IsChecked="{Binding IsSelected, Mode=TwoWay}" />
                                                                        </DataTemplate>
                                                                    </ItemsControl.ItemTemplate>
                                                                </ItemsControl>
                                                            </ScrollViewer>
                                                        </Border>
                                                    </Popup>
                                                </Grid>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.HeaderTemplate>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <Border x:Name="TagsContainer"
                                                            HorizontalAlignment="Stretch"
                                                            VerticalAlignment="Center"
                                                            MaxHeight="{StaticResource IMM.TagRowMaxHeight}"
                                                            ClipToBounds="True">
                                                        <ItemsControl x:Name="TagsItemsControl"
                                                                      Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType={x:Type DataGridCell}}}"
                                                                      HorizontalAlignment="Left"
                                                                      ItemsSource="{Binding DatabaseTags}"
                                                                      ItemTemplate="{StaticResource IMM.TagBadgeTemplate}"
                                                                      ItemsPanel="{StaticResource IMM.TagItemsPanelTemplate}" />
                                                    </Border>
                                                    <TextBlock x:Name="NoTagsText"
                                                               Text="â€”"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"
                                                               Visibility="Collapsed" />
                                                </Grid>
                                                <DataTemplate.Triggers>
                                                    <DataTrigger Binding="{Binding DatabaseTags.Count}" Value="0">
                                                        <Setter TargetName="TagsContainer" Property="Visibility"
                                                                Value="Collapsed" />
                                                        <Setter TargetName="NoTagsText" Property="Visibility"
                                                                Value="Visible" />
                                                    </DataTrigger>
                                                    <DataTrigger
                                                        Binding="{Binding DataContext.IsCompactView, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                        Value="True">
                                                        <Setter TargetName="TagsContainer" Property="MaxHeight"
                                                                Value="{StaticResource IMM.TagRowCompactMaxHeight}" />
                                                    </DataTrigger>
                                                </DataTemplate.Triggers>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                        <DataGridTemplateColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTemplateColumn.CellStyle>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn x:Name="ModDbUserReportsColumn" Header="User Reports"
                                                            Width="150" IsReadOnly="True">
                                        <DataGridTemplateColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTemplateColumn.CellStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button
                                                    Content="{Binding UserReportDisplay}"
                                                    ToolTip="{Binding UserReportTooltip}"
                                                    Click="UserReportsButton_OnClick"
                                                    IsEnabled="{Binding CanSubmitUserReport}"
                                                    HorizontalAlignment="Stretch" ClipToBounds="True">
                                                    <Button.Style>
                                                        <Style TargetType="{x:Type Button}"
                                                               BasedOn="{StaticResource IMM.UserReportButtonStyle}">
                                                            <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                            <Setter Property="Padding" Value="4,0" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding IsUserReportLoading}"
                                                                             Value="True">
                                                                    <Setter Property="Cursor" Value="Wait" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding UserReportHasError}"
                                                                             Value="True">
                                                                    <Setter Property="Foreground"
                                                                            Value="{DynamicResource Brush.Text.Emphasis}" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn x:Name="ModDbSideColumn" Header="Side"
                                                        Binding="{Binding SideDisplay, Mode=OneWay}"
                                                        SortMemberPath="SideSortValue"
                                                        Width="90"
                                                        MinWidth="80"
                                                        IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="HorizontalAlignment" Value="Center" />
                                                <Setter Property="VerticalAlignment" Value="Center" />
                                                <Setter Property="TextAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.CellStyle>
                                            <Style TargetType="{x:Type DataGridCell}"
                                                   BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                            </Style>
                                        </DataGridTextColumn.CellStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>
                </Border>
                <TextBlock Grid.Row="1"
                           Panel.ZIndex="1"
                           Margin="32"
                           Text="{Binding NoModsFoundMessage}"
                           TextWrapping="Wrap"
                           TextAlignment="Center"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           FontSize="16"
                           Foreground="{DynamicResource Brush.Text.Primary}"
                           IsHitTestVisible="False">
                    <TextBlock.Style>
                        <Style TargetType="{x:Type TextBlock}">
                            <Setter Property="Visibility" Value="Collapsed" />
                            <Style.Triggers>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding TotalMods}" Value="0" />
                                        <Condition Binding="{Binding SearchModDatabase}" Value="False" />
                                        <Condition Binding="{Binding IsViewingCloudModlists}" Value="False" />
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="Visibility" Value="Visible" />
                                </MultiDataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>
                <Grid x:Name="Modlists" Grid.RowSpan="2" Margin="0,0,-29,0">
                    <Grid.Style>
                        <Style TargetType="{x:Type Grid}">
                            <Setter Property="Visibility" Value="Collapsed" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsViewingCloudModlists}" Value="True">
                                    <Setter Property="Visibility" Value="Visible" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Grid.Style>

                    <TabControl x:Name="ModlistsTabControl"
                                Background="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                BorderThickness="0"
                                ItemContainerStyle="{StaticResource IMM.ModlistsTabItemStyle}"
                                SelectionChanged="ModlistsTabControl_OnSelectionChanged">
                        <TabItem x:Name="LocalModlistsTabItem"
                                 Header="Local">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <Rectangle Grid.Row="0"
                                           Margin="0,0,0,16"
                                           Fill="{DynamicResource Brush.DataGrid.Background}" />

                                <Border Grid.Row="0"

                                        Margin="0,0,0,16"

                                        Background="Transparent"
                                        BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Light}"
                                        BorderThickness="0,0,2,2"
                                        CornerRadius="0"
                                        SnapsToDevicePixels="True">
                                    <Border Background="Transparent"
                                            BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Dark}"
                                            BorderThickness="2,2,0,0"
                                            CornerRadius="0"
                                            SnapsToDevicePixels="True">
                                        <DataGrid x:Name="LocalModlistsDataGrid"
                                                  ItemsSource="{Binding LocalModlistsView}"
                                                  AutoGenerateColumns="False"
                                                  CanUserAddRows="False"
                                                  CanUserDeleteRows="False"
                                                  IsReadOnly="True"
                                                  SelectionMode="Extended"
                                                  SelectionUnit="FullRow"
                                                  GridLinesVisibility="None"
                                                  RowHeaderWidth="0"
                                                  BorderThickness="0,1,2,1"
                                                  HorizontalGridLinesBrush="Transparent"
                                                  VerticalGridLinesBrush="Transparent"
                                                  HeadersVisibility="Column"
                                                  ui:ControlHelper.CornerRadius="0"
                                                  FontSize="15"
                                                  Foreground="{DynamicResource Brush.Text.Primary}"
                                                  SelectionChanged="LocalModlistsDataGrid_OnSelectionChanged"
                                                  Background="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                                  BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                                  RowBackground="{DynamicResource Brush.Panel.Primary.Background.Solid}">
                                            <DataGrid.Resources>
                                                <Style TargetType="{x:Type ScrollBar}"
                                                       BasedOn="{StaticResource IMM.DataGridScrollBarStyle}" />
                                                <Style TargetType="{x:Type Thumb}"
                                                       BasedOn="{StaticResource IMM.DataGridScrollBarThumbStyle}" />
                                                <Style TargetType="{x:Type TextBlock}">
                                                    <Setter Property="TextWrapping" Value="Wrap" />
                                                </Style>
                                                <Style TargetType="{x:Type DataGridColumnHeader}"
                                                       BasedOn="{StaticResource IMM.PrimaryDataGridColumnHeaderStyle}" />
                                            </DataGrid.Resources>
                                            <DataGrid.CellStyle>
                                                <StaticResource ResourceKey="IMM.DataGridCellBaseStyle" />
                                            </DataGrid.CellStyle>

                                            <DataGrid.RowHeaderStyle>
                                                <Style />
                                            </DataGrid.RowHeaderStyle>
                                            <DataGrid.RowStyle>
                                                <Style TargetType="{x:Type DataGridRow}">
                                                    <Setter Property="Background" Value="Transparent" />
                                                    <Setter Property="BorderBrush"
                                                            Value="{DynamicResource Brush.Panel.Secondary.Background.Solid}" />
                                                    <Setter Property="BorderThickness" Value="0" />
                                                    <Setter Property="Margin" Value="10,2,10,2" />
                                                    <Setter Property="Foreground"
                                                            Value="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                                                    <Setter Property="Padding">
                                                        <Setter.Value>
                                                            <MultiBinding Converter="{StaticResource IMM.RowPaddingOffsetConverter}">
                                                                <Binding Source="{StaticResource IMM.RowPaddingBase}" />
                                                                <Binding Source="{StaticResource IMM.NormalRowHeightOffset}" />
                                                            </MultiBinding>
                                                        </Setter.Value>
                                                    </Setter>
                                                    <Setter Property="Height" Value="{x:Static sys:Double.NaN}" />
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="{x:Type DataGridRow}">
                                                                <Border x:Name="RowBorder"
                                                                        Background="{DynamicResource Brush.Panel.Primary.Background.Solid}"
                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                                        CornerRadius="0"
                                                                        Margin="4,0,4,4"
                                                                        SnapsToDevicePixels="True">
                                                                    <Grid>
                                                                        <Border x:Name="SelectionOverlay"
                                                                                Background="{DynamicResource Brush.Accent.Primary}"
                                                                                Opacity="0"
                                                                                CornerRadius="0"
                                                                                IsHitTestVisible="False" />
                                                                        <Border x:Name="HoverOverlay"
                                                                                Background="{DynamicResource Brush.Button.Primary.Background.Hover}"
                                                                                Opacity="0"
                                                                                CornerRadius="0"
                                                                                IsHitTestVisible="False" />
                                                                        <Border Padding="{TemplateBinding Padding}"
                                                                                Background="Transparent"
                                                                                CornerRadius="0">
                                                                            <SelectiveScrollingGrid>
                                                                                <SelectiveScrollingGrid.ColumnDefinitions>
                                                                                    <ColumnDefinition Width="*" />
                                                                                </SelectiveScrollingGrid.ColumnDefinitions>
                                                                                <SelectiveScrollingGrid.RowDefinitions>
                                                                                    <RowDefinition Height="*" />
                                                                                    <RowDefinition Height="Auto" />
                                                                                </SelectiveScrollingGrid.RowDefinitions>
                                                                                <DataGridCellsPresenter Grid.Column="0"
                                                                                        SelectiveScrollingGrid.SelectiveScrollingOrientation="Both" />
                                                                                <DataGridDetailsPresenter Grid.Column="0"
                                                                                        Grid.Row="1"
                                                                                        SelectiveScrollingGrid.SelectiveScrollingOrientation="Horizontal"
                                                                                        Visibility="{TemplateBinding DetailsVisibility}" />
                                                                            </SelectiveScrollingGrid>
                                                                        </Border>
                                                                    </Grid>
                                                                </Border>
                                                                <ControlTemplate.Triggers>
                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                        <Setter TargetName="HoverOverlay" Property="Opacity" Value="0.1" />
                                                                        <Setter TargetName="RowBorder" Property="BorderBrush"
                                                                                Value="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                                                                    </Trigger>
                                                                    <Trigger Property="IsMouseOver" Value="False">
                                                                        <Setter TargetName="HoverOverlay" Property="Opacity" Value="0" />
                                                                    </Trigger>
                                                                    <Trigger Property="IsSelected" Value="True">
                                                                        <Setter TargetName="SelectionOverlay" Property="Opacity" Value="0.25" />
                                                                        <Setter TargetName="HoverOverlay" Property="Opacity" Value="0" />
                                                                        <Setter TargetName="RowBorder" Property="BorderBrush"
                                                                                Value="{DynamicResource Brush.Panel.Secondary.Background.Solid}" />
                                                                        <Setter TargetName="RowBorder" Property="BorderThickness" Value="0" />
                                                                    </Trigger>
                                                                    <Trigger Property="IsSelected" Value="False">
                                                                        <Setter TargetName="SelectionOverlay" Property="Opacity" Value="0" />
                                                                        <Setter TargetName="RowBorder" Property="BorderThickness" Value="0" />
                                                                    </Trigger>
                                                                </ControlTemplate.Triggers>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                    <Style.Triggers>
                                                        <Trigger Property="IsSelected" Value="True">
                                                            <Setter Property="Foreground"
                                                                    Value="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGrid.RowStyle>
                                            <DataGrid.Style>
                                                <Style TargetType="{x:Type DataGrid}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding HasLocalModlists}" Value="False">
                                                            <Setter Property="Visibility" Value="Collapsed" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGrid.Style>
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Name"
                                                                    Binding="{Binding DisplayName}"
                                                                    Width="260"
                                                                    MinWidth="200"
                                                                    IsReadOnly="True">
                                                    <DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="{x:Type TextBlock}">
                                                            <Setter Property="VerticalAlignment" Value="Center" />
                                                            <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                            <Setter Property="ToolTip" Value="{Binding DisplayName}" />
                                                        </Style>
                                                    </DataGridTextColumn.ElementStyle>
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                                            <Setter Property="Margin" Value="10,0,0,0" />
                                                            <Setter Property="FontWeight" Value="Bold" />
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Header="Uploader"
                                                                    Binding="{Binding UploaderDisplay}"
                                                                    Width="220"
                                                                    MinWidth="180"
                                                                    IsReadOnly="True">
                                                    <DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="{x:Type TextBlock}">
                                                            <Setter Property="VerticalAlignment" Value="Center" />
                                                            <Setter Property="TextAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.ElementStyle>
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Header="Version"
                                                                    Width="120"
                                                                    Binding="{Binding Version, FallbackValue=â€”, TargetNullValue=â€”}"
                                                                    IsReadOnly="True">
                                                    <DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="{x:Type TextBlock}">
                                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                                            <Setter Property="VerticalAlignment" Value="Center" />
                                                            <Setter Property="TextAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.ElementStyle>
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Header="VS Version"
                                                                    Width="120"
                                                                    Binding="{Binding GameVersionDisplay}"
                                                                    IsReadOnly="True">
                                                    <DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="{x:Type TextBlock}">
                                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                                            <Setter Property="VerticalAlignment" Value="Center" />
                                                            <Setter Property="TextAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.ElementStyle>
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Header="Last Modified"
                                                                    Width="180"
                                                                    Binding="{Binding LastModifiedDisplay}"
                                                                    SortMemberPath="LastModified"
                                                                    IsReadOnly="True">
                                                    <DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="{x:Type TextBlock}">
                                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                                            <Setter Property="VerticalAlignment" Value="Center" />
                                                            <Setter Property="TextAlignment" Value="Center" />
                                                            <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                            <Setter Property="ToolTip" Value="{Binding LastModifiedDisplay}" />
                                                        </Style>
                                                    </DataGridTextColumn.ElementStyle>
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                </DataGridTextColumn>
                                                <DataGridTemplateColumn Header="Mods" Width="200" MinWidth="180" IsReadOnly="True">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <Grid>
                                                                <ComboBox x:Name="LocalModsComboBox"
                                                                          ItemsSource="{Binding Mods, Mode=OneWay}"
                                                                          IsEditable="True"
                                                                          IsReadOnly="True"
                                                                          SelectedIndex="-1"
                                                                          MaxDropDownHeight="240" />
                                                                <TextBlock Text="{Binding ModsSummary, Mode=OneWay}"
                                                                           Foreground="{DynamicResource Brush.Text.Primary}"
                                                                           HorizontalAlignment="Center"
                                                                           VerticalAlignment="Center"
                                                                           IsHitTestVisible="False">
                                                                    <TextBlock.Style>
                                                                        <Style TargetType="{x:Type TextBlock}">
                                                                            <Setter Property="Visibility" Value="Visible" />
                                                                            <Setter Property="Margin" Value="8,0,24,0" />
                                                                            <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                                            <Setter Property="TextAlignment" Value="Center" />
                                                                            <Style.Triggers>
                                                                                <DataTrigger Binding="{Binding IsDropDownOpen, ElementName=LocalModsComboBox}" Value="True">
                                                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                                                </DataTrigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </TextBlock.Style>
                                                                </TextBlock>
                                                            </Grid>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                    <DataGridTemplateColumn.CellStyle>
                                                        <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTemplateColumn.CellStyle>
                                                </DataGridTemplateColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Border>
                                </Border>

                                <TextBlock Grid.Row="0"
                                           Text="No local modlists found."
                                           FontSize="16"
                                           Foreground="{DynamicResource Brush.Text.Primary}"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           TextAlignment="Center"
                                           TextWrapping="Wrap">
                                    <TextBlock.Style>
                                        <Style TargetType="{x:Type TextBlock}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding HasLocalModlists}" Value="False">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>

                                <Border Grid.Row="1"
                                        Margin="10,10,0,0"
                                        Background="{DynamicResource Brush.ModCard.Background.Active}"
                                        CornerRadius="10,10,10,10"
                                        Height="180">
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="6" ShadowDepth="3" Direction="270" Opacity="0.2" />
                                    </Border.Effect>

                                    <Grid Height="160"
                                          VerticalAlignment="Center"
                                          HorizontalAlignment="Left"
                                          Width="1161">
                                        <Button x:Name="SaveLocalModlistButton"
                                                Content="Save Modlist (Local)"
                                                Padding="12,0,12,0"
                                                Margin="10,84,0,0"
                                                MinWidth="165"
                                                Click="SaveLocalModlistButton_OnClick"
                                                Height="32"
                                                Width="185"
                                                VerticalAlignment="Top"
                                                HorizontalAlignment="Left" />
                                        <Button x:Name="InstallLocalModlistButton"
                                                Content="Install Selected Modlist"
                                                Padding="12,0,12,0"
                                                Margin="200,121,0,0"
                                                MinWidth="165"
                                                Click="InstallLocalModlistButton_OnClick"
                                                Height="32"
                                                Width="192"
                                                VerticalAlignment="Top"
                                                HorizontalAlignment="Left"
                                                IsEnabled="False" />
                                        <Button x:Name="DeleteLocalModlistsButton"
                                                Content="Delete"
                                                Padding="12,0,12,0"
                                                Margin="10,47,0,0"
                                                MinWidth="165"
                                                Click="DeleteLocalModlistsButton_OnClick"
                                                Height="32"
                                                Width="185"
                                                VerticalAlignment="Top"
                                                HorizontalAlignment="Left"
                                                IsEnabled="False" />
                                        <Button x:Name="OpenModlistsFolderButton"
                                                Content="Open Modlists Folder"
                                                Padding="12,0,12,0"
                                                Margin="10,121,0,0"
                                                MinWidth="165"
                                                Click="OpenModlistsFolderButton_OnClick"
                                                Height="32"
                                                Width="185"
                                                VerticalAlignment="Top"
                                                HorizontalAlignment="Left" />
                                        <Button x:Name="ModifyLocalModlistButton"
                                                Content="Modify"
                                                Padding="12,0,12,0"
                                                Margin="10,10,0,0"
                                                MinWidth="165"
                                                Click="ModifyLocalModlistButton_OnClick"
                                                Height="32"
                                                Width="185"
                                                VerticalAlignment="Top"
                                                HorizontalAlignment="Left"
                                                IsEnabled="False" />
                                        <Border HorizontalAlignment="Left"
                                                Margin="200,10,0,0"
                                                CornerRadius="5"
                                                Width="942"
                                                Background="Transparent"
                                                BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Light}"
                                                BorderThickness="0,0,2,2"
                                                SnapsToDevicePixels="True" Height="106" VerticalAlignment="Top">
                                            <Border Background="{DynamicResource Brush.ModCard.Background.Active}"
                                                    BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Dark}"
                                                    BorderThickness="2,2,0,0"
                                                    CornerRadius="5"
                                                    Padding="10"
                                                    SnapsToDevicePixels="True"
                                                    ClipToBounds="True">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>
                                                    <TextBlock x:Name="SelectedLocalModlistTitle"
                                                               Grid.Row="0"
                                                               TextWrapping="Wrap"
                                                               Text=""
                                                               FontWeight="Bold"
                                                               Foreground="{DynamicResource Brush.Text.Primary}" Margin="0,0,0,66" Grid.RowSpan="2" />
                                                    <TextBlock x:Name="SelectedLocalModlistDescription"
                                                               Grid.Row="1"
                                                               Margin="0,8,0,0"
                                                               TextWrapping="Wrap"
                                                               Text=""
                                                               Foreground="{DynamicResource Brush.Text.Primary}" />
                                                </Grid>
                                            </Border>
                                        </Border>
                                    </Grid>
                                </Border>
                            </Grid>
                        </TabItem>
                        <TabItem x:Name="OnlineModlistsTabItem"
                                 Header="Online">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <Rectangle Grid.Row="0"
                                           Margin="0,0,0,22"
                                           Fill="{DynamicResource Brush.DataGrid.Background}" />

                                <Border Grid.Row="0"
                                        Margin="0,0,0,22"
                                        Background="Transparent"
                                        BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Light}"
                                        BorderThickness="0,0,2,2"
                                        CornerRadius="0"
                                        SnapsToDevicePixels="True">
                                    <Border Background="Transparent"
                                            BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Dark}"
                                            BorderThickness="2,2,0,0"
                                            CornerRadius="0"
                                            SnapsToDevicePixels="True">
                                        <DataGrid x:Name="CloudModlistsDataGrid"
                                                  ItemsSource="{Binding CloudModlistsView}"
                                                  AutoGenerateColumns="False"
                                                  CanUserAddRows="False"
                                                  CanUserDeleteRows="False"
                                                  IsReadOnly="True"
                                                  SelectionMode="Single"
                                                  SelectionUnit="FullRow"
                                                  IsEnabled="{Binding CanAccessCloudModlists}"
                                                  GridLinesVisibility="None"
                                                  RowHeaderWidth="0"
                                                  BorderThickness="0,1,2,1"
                                                  HorizontalGridLinesBrush="Transparent"
                                                  VerticalGridLinesBrush="Transparent"
                                                  HeadersVisibility="Column"
                                                  ui:ControlHelper.CornerRadius="0"
                                                  FontSize="15"
                                                  Foreground="{DynamicResource Brush.Text.Primary}"
                                                  SelectionChanged="CloudModlistsDataGrid_OnSelectionChanged"
                                                  Background="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                                  BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                                  RowBackground="{DynamicResource Brush.Panel.Primary.Background.Solid}">
                                            <DataGrid.Resources>
                                                <Style TargetType="{x:Type ScrollBar}"
                                                       BasedOn="{StaticResource IMM.DataGridScrollBarStyle}" />
                                                <Style TargetType="{x:Type Thumb}"
                                                       BasedOn="{StaticResource IMM.DataGridScrollBarThumbStyle}" />
                                                <Style TargetType="{x:Type TextBlock}">
                                                    <Setter Property="TextWrapping" Value="Wrap" />
                                                </Style>
                                                <Style TargetType="{x:Type DataGridColumnHeader}"
                                                       BasedOn="{StaticResource IMM.PrimaryDataGridColumnHeaderStyle}" />
                                            </DataGrid.Resources>
                                            <DataGrid.CellStyle>
                                                <StaticResource ResourceKey="IMM.DataGridCellBaseStyle" />
                                            </DataGrid.CellStyle>

                                            <DataGrid.RowHeaderStyle>
                                                <Style />
                                            </DataGrid.RowHeaderStyle>
                                            <DataGrid.RowStyle>
                                                <Style TargetType="{x:Type DataGridRow}">
                                                    <Setter Property="Background" Value="Transparent" />
                                                    <Setter Property="BorderBrush"
                                                            Value="{DynamicResource Brush.Panel.Secondary.Background.Solid}" />
                                                    <Setter Property="BorderThickness" Value="0" />
                                                    <Setter Property="Margin" Value="10,2,10,2" />
                                                    <Setter Property="Foreground"
                                                            Value="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                                                    <Setter Property="Padding">
                                                        <Setter.Value>
                                                            <MultiBinding Converter="{StaticResource IMM.RowPaddingOffsetConverter}">
                                                                <Binding Source="{StaticResource IMM.RowPaddingBase}" />
                                                                <Binding Source="{StaticResource IMM.NormalRowHeightOffset}" />
                                                            </MultiBinding>
                                                        </Setter.Value>
                                                    </Setter>
                                                    <Setter Property="Height" Value="{x:Static sys:Double.NaN}" />
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="{x:Type DataGridRow}">
                                                                <Border x:Name="RowBorder"
                                                                        Background="{DynamicResource Brush.Panel.Primary.Background.Solid}"
                                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                                        CornerRadius="0"
                                                                        Margin="4,0,4,4"
                                                                        SnapsToDevicePixels="True">
                                                                    <Grid>
                                                                        <Border x:Name="SelectionOverlay"
                                                                                Background="{DynamicResource Brush.Accent.Primary}"
                                                                                Opacity="0"
                                                                                CornerRadius="0"
                                                                                IsHitTestVisible="False" />
                                                                        <Border x:Name="HoverOverlay"
                                                                                Background="{DynamicResource Brush.Button.Primary.Background.Hover}"
                                                                                Opacity="0"
                                                                                CornerRadius="0"
                                                                                IsHitTestVisible="False" />
                                                                        <Border Padding="{TemplateBinding Padding}"
                                                                                Background="Transparent"
                                                                                CornerRadius="0">
                                                                            <SelectiveScrollingGrid>
                                                                                <SelectiveScrollingGrid.ColumnDefinitions>
                                                                                    <ColumnDefinition Width="*" />
                                                                                </SelectiveScrollingGrid.ColumnDefinitions>
                                                                                <SelectiveScrollingGrid.RowDefinitions>
                                                                                    <RowDefinition Height="*" />
                                                                                    <RowDefinition Height="Auto" />
                                                                                </SelectiveScrollingGrid.RowDefinitions>
                                                                                <DataGridCellsPresenter Grid.Column="0"
                                                                                        SelectiveScrollingGrid.SelectiveScrollingOrientation="Both" />
                                                                                <DataGridDetailsPresenter Grid.Column="0"
                                                                                        Grid.Row="1"
                                                                                        SelectiveScrollingGrid.SelectiveScrollingOrientation="Horizontal"
                                                                                        Visibility="{TemplateBinding DetailsVisibility}" />
                                                                            </SelectiveScrollingGrid>
                                                                        </Border>
                                                                    </Grid>
                                                                </Border>
                                                                <ControlTemplate.Triggers>
                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                        <Setter TargetName="HoverOverlay" Property="Opacity" Value="0.1" />
                                                                        <Setter TargetName="RowBorder" Property="BorderBrush"
                                                                                Value="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                                                                    </Trigger>
                                                                    <Trigger Property="IsMouseOver" Value="False">
                                                                        <Setter TargetName="HoverOverlay" Property="Opacity" Value="0" />
                                                                    </Trigger>
                                                                    <Trigger Property="IsSelected" Value="True">
                                                                        <Setter TargetName="SelectionOverlay" Property="Opacity" Value="0.25" />
                                                                        <Setter TargetName="HoverOverlay" Property="Opacity" Value="0" />
                                                                        <Setter TargetName="RowBorder" Property="BorderBrush"
                                                                                Value="{DynamicResource Brush.Panel.Secondary.Background.Solid}" />
                                                                        <Setter TargetName="RowBorder" Property="BorderThickness" Value="0" />
                                                                    </Trigger>
                                                                    <Trigger Property="IsSelected" Value="False">
                                                                        <Setter TargetName="SelectionOverlay" Property="Opacity" Value="0" />
                                                                        <Setter TargetName="RowBorder" Property="BorderThickness" Value="0" />
                                                                    </Trigger>
                                                                </ControlTemplate.Triggers>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                    <Style.Triggers>
                                                        <Trigger Property="IsSelected" Value="True">
                                                            <Setter Property="Foreground"
                                                                    Value="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGrid.RowStyle>
                                            <DataGrid.Style>
                                                <Style TargetType="{x:Type DataGrid}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding HasCloudModlists}" Value="False">
                                                            <Setter Property="Visibility" Value="Collapsed" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGrid.Style>
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Name"
                                                                    Binding="{Binding DisplayName}"
                                                                    Width="260"
                                                                    MinWidth="200"
                                                                    IsReadOnly="True">
                                                    <DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="{x:Type TextBlock}">
                                                            <Setter Property="VerticalAlignment" Value="Center" />
                                                            <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                            <Setter Property="ToolTip" Value="{Binding DisplayName}" />
                                                        </Style>
                                                    </DataGridTextColumn.ElementStyle>
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                                            <Setter Property="Margin" Value="10,0,0,0" />
                                                            <Setter Property="FontWeight" Value="Bold" />
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Header="Uploader"
                                                                    Binding="{Binding Uploader}"
                                                                    Width="220"
                                                                    MinWidth="180"
                                                                    IsReadOnly="True">
                                                    <DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="{x:Type TextBlock}">
                                                            <Setter Property="VerticalAlignment" Value="Center" />
                                                            <Setter Property="TextAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.ElementStyle>
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Header="Version"
                                                                    Width="120"
                                                                    Binding="{Binding Version, FallbackValue=â€”, TargetNullValue=â€”}"
                                                                    IsReadOnly="True">
                                                    <DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="{x:Type TextBlock}">
                                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                                            <Setter Property="VerticalAlignment" Value="Center" />
                                                            <Setter Property="TextAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.ElementStyle>
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Header="VS Version"
                                                                    Width="120"
                                                                    Binding="{Binding GameVersionDisplay}"
                                                                    IsReadOnly="True">
                                                    <DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="{x:Type TextBlock}">
                                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                                            <Setter Property="VerticalAlignment" Value="Center" />
                                                            <Setter Property="TextAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.ElementStyle>
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Header="Date Added"
                                                                    Width="180"
                                                                    Binding="{Binding DateAddedDisplay}"
                                                                    SortMemberPath="DateAdded"
                                                                    IsReadOnly="True">
                                                    <DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="{x:Type TextBlock}">
                                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                                            <Setter Property="VerticalAlignment" Value="Center" />
                                                            <Setter Property="TextAlignment" Value="Center" />
                                                            <Setter Property="ToolTipService.ShowDuration" Value="60000" />
                                                            <Setter Property="ToolTip" Value="{Binding DateAddedDisplay}" />
                                                        </Style>
                                                    </DataGridTextColumn.ElementStyle>
                                                    <DataGridTextColumn.CellStyle>
                                                        <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTextColumn.CellStyle>
                                                </DataGridTextColumn>
                                                <DataGridTemplateColumn Header="Mods" Width="200" MinWidth="180" IsReadOnly="True">
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <Grid>
                                                                <ComboBox x:Name="ModsComboBox"
                                                                          ItemsSource="{Binding Mods, Mode=OneWay}"
                                                                          IsEditable="True"
                                                                          IsReadOnly="True"
                                                                          SelectedIndex="-1"
                                                                          MaxDropDownHeight="240" />
                                                                <TextBlock Text="{Binding ModsSummary, Mode=OneWay}"
                                                                           Foreground="{DynamicResource Brush.Text.Primary}"
                                                                           HorizontalAlignment="Center"
                                                                           VerticalAlignment="Center"
                                                                           IsHitTestVisible="False">
                                                                    <TextBlock.Style>
                                                                        <Style TargetType="{x:Type TextBlock}">
                                                                            <Setter Property="Visibility" Value="Visible" />
                                                                            <Setter Property="Margin" Value="8,0,24,0" />
                                                                            <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                                            <Setter Property="TextAlignment" Value="Center" />
                                                                            <Style.Triggers>
                                                                                <DataTrigger Binding="{Binding IsDropDownOpen, ElementName=ModsComboBox}" Value="True">
                                                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                                                </DataTrigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </TextBlock.Style>
                                                                </TextBlock>
                                                            </Grid>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                    <DataGridTemplateColumn.CellStyle>
                                                        <Style TargetType="{x:Type DataGridCell}"
                                                               BasedOn="{StaticResource IMM.DataGridCellBaseStyle}">
                                                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                            <Setter Property="VerticalContentAlignment" Value="Center" />
                                                        </Style>
                                                    </DataGridTemplateColumn.CellStyle>
                                                </DataGridTemplateColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Border>
                                </Border>

                                <TextBlock Grid.Row="0"
                                           Text="Loading online modlists..."
                                           FontSize="16"
                                           Foreground="{DynamicResource Brush.Text.Primary}"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           TextAlignment="Center"
                                           TextWrapping="Wrap">
                                    <TextBlock.Style>
                                        <Style TargetType="{x:Type TextBlock}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding HasCloudModlists}" Value="False">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>

                                <Border Grid.Row="1"
                                        Margin="10,0,10,0"
                                        Background="{DynamicResource Brush.ModCard.Background.Active}"
                                        CornerRadius="10,10,10,10"
                                        Height="175"
                                        VerticalAlignment="Center">
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="6" ShadowDepth="3" Direction="270" Opacity="0.2" />
                                    </Border.Effect>

                                    <Grid Height="151"
                                          VerticalAlignment="Center"
                                          HorizontalAlignment="Left"
                                          Width="1227"
                                          IsEnabled="{Binding CanAccessCloudModlists}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="197*"/>
                                            <ColumnDefinition Width="955*"/>
                                        </Grid.ColumnDefinitions>
                                        <Button x:Name="InstallCloudModlistButton"
                                                Content="Install Selected Modlist"
                                                Padding="12,0,12,0"
                                                MinWidth="185"
                                                IsEnabled="False"
                                                Visibility="Visible"
                                                Click="InstallCloudModlistButton_OnClick"
                                                Margin="10,35,0,0"
                                                Height="32"
                                                Width="198"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top" />
                                        <Button x:Name="SaveCloudModlistButton"
                                                Content="Save Modlist (Online)"
                                                Padding="12,0,12,0"
                                                Margin="10,109,0,0"
                                                MinWidth="165"
                                                Click="SaveCloudModlistButton_OnClick"
                                                Height="32"
                                                Width="198"
                                                VerticalAlignment="Top"
                                                HorizontalAlignment="Left" />
                                        <Button x:Name="ModifyCloudModlistsButton"
                                                Content="Modify Modlists"
                                                Padding="12,0,12,0"
                                                Margin="10,72,0,0"
                                                MinWidth="165"
                                                Click="ModifyCloudModlistsButton_OnClick"
                                                Height="32"
                                                Width="198"
                                                VerticalAlignment="Top"
                                                HorizontalAlignment="Left" />
                                        <Button x:Name="RefreshCloudModlistsButton"
                                                Content="Refresh"
                                                Padding="12,0,12,0"
                                                MinWidth="100"
                                                Click="RefreshCloudModlistsButton_OnClick"
                                                Margin="898,109,0,0"
                                                Height="32"
                                                Width="109"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top" Grid.Column="1" />
                                        <Border HorizontalAlignment="Left"
                                                Height="131"
                                                Margin="3,0,0,0"
                                                VerticalAlignment="Center"
                                                CornerRadius="5"
                                                Width="877"
                                                Background="Transparent"
                                                BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Light}"
                                                BorderThickness="0,0,2,2"
                                                SnapsToDevicePixels="True" Grid.Column="1">
                                            <Border Background="{DynamicResource Brush.ModCard.Background.Active}"
                                                    BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Dark}"
                                                    BorderThickness="2,2,0,0"
                                                    CornerRadius="5"
                                                    Padding="10"
                                                    SnapsToDevicePixels="True"
                                                    ClipToBounds="True">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>
                                                    <TextBlock x:Name="SelectedModlistTitle"
                                                               Grid.Row="0"
                                                               TextWrapping="Wrap"
                                                               Text=""
                                                               FontWeight="Bold"
                                                               Foreground="{DynamicResource Brush.Text.Primary}" />
                                                    <ScrollViewer Grid.Row="1"
                                                                  Margin="0,8,0,0"
                                                                  Padding="0,0,4,0"
                                                                  HorizontalScrollBarVisibility="Disabled"
                                                                  VerticalScrollBarVisibility="Auto"
                                                                  CanContentScroll="False"
                                                                  PanningMode="VerticalOnly">
                                                        <ScrollViewer.Resources>
                                                            <Style TargetType="{x:Type ScrollBar}"
                                                                   BasedOn="{StaticResource IMM.SlimScrollBarStyle}" />
                                                        </ScrollViewer.Resources>
                                                        <TextBlock x:Name="SelectedModlistDescription"
                                                                   TextWrapping="Wrap"
                                                                   Text=""
                                                                   Foreground="{DynamicResource Brush.Text.Primary}" />
                                                    </ScrollViewer>
                                                </Grid>
                                            </Border>
                                        </Border>
                                    </Grid>
                                </Border>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </Grid>
            </Grid>
            <ListView x:Name="ModDatabaseCardsListView"
                      ItemsSource="{Binding CurrentModsView}"
                      Background="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                      BorderThickness="1,1,1,1"
                      Margin="0,32,0,0"
                      ui:ControlHelper.CornerRadius="0"
                      SelectionMode="Single"
                      SelectionChanged="ModDatabaseCardsListView_OnSelectionChanged"
                      PreviewMouseWheel="ModsDataGrid_OnPreviewMouseWheel"
                      ScrollViewer.ScrollChanged="ModDatabaseCardsListView_OnScrollChanged"
                      ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                      ScrollViewer.CanContentScroll="True"
                      VirtualizingPanel.IsVirtualizing="True"
                      VirtualizingPanel.VirtualizationMode="Recycling"
                      Grid.RowSpan="2" BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                      FontSize="16">
                <ListView.Style>
                    <Style TargetType="{x:Type ListView}">
                        <Setter Property="Visibility" Value="Collapsed" />
                        <Style.Triggers>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding SearchModDatabase}" Value="True" />
                                    <Condition Binding="{Binding UseModDbDesignView}" Value="True" />
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Visibility" Value="Visible" />
                            </MultiDataTrigger>
                        </Style.Triggers>
                    </Style>
                </ListView.Style>
                <ListView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel Orientation="Horizontal"
                                   HorizontalAlignment="Center"
                                   Margin="0,20,0,72"
                                   ItemWidth="{Binding ConverterParameter=496, Converter={StaticResource IMM.ScaledDoubleConverter}, Source={StaticResource IMM.ModDbCardScale}}" />
                    </ItemsPanelTemplate>
                </ListView.ItemsPanel>
                <ListView.ItemContainerStyle>
                    <Style TargetType="{x:Type ListViewItem}">
                        <Setter Property="Padding" Value="0" />
                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                        <Setter Property="VerticalContentAlignment" Value="Stretch" />
                        <Setter Property="Background" Value="Transparent" />
                        <Setter Property="BorderThickness" Value="0" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type ListViewItem}">
                                    <ContentPresenter />
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <EventSetter Event="UIElement.PreviewMouseLeftButtonDown"
                                     Handler="ModDatabaseCard_OnPreviewMouseLeftButtonDown" />
                    </Style>
                </ListView.ItemContainerStyle>
                <ListView.ItemTemplate>
                    <DataTemplate DataType="{x:Type viewModels:ModListItemViewModel}">
                        <Border Width="480"
                                Height="480"
                                Margin="{Binding LayoutTransform.(ScaleTransform.ScaleX), ConverterParameter=0\,0\,16\,16, Converter={StaticResource IMM.ScaledThicknessConverter}, RelativeSource={RelativeSource Mode=Self}}"
                                CornerRadius="12"
                                ClipToBounds="False">
                            <Border.LayoutTransform>
                                <ScaleTransform ScaleX="{StaticResource IMM.ModDbCardScale}"
                                                ScaleY="{StaticResource IMM.ModDbCardScale}" />
                            </Border.LayoutTransform>
                            <Border.Effect>
                                <DropShadowEffect
                                    Color="{Binding Source={StaticResource Brush.DataGrid.RowShadow}, Path=Color}"
                                    BlurRadius="2" Direction="210" ShadowDepth="2" Opacity="0.5" />

                            </Border.Effect>
                            <Border.Style>
                                <Style TargetType="{x:Type Border}">
                                    <Setter Property="BorderBrush"
                                            Value="{DynamicResource Brush.Panel.Secondary.Background.Solid}" />
                                    <Setter Property="BorderThickness" Value="1" />
                                    <Setter Property="Background"
                                            Value="{DynamicResource Brush.Panel.Primary.Background.Solid}" />
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="BorderBrush"
                                                    Value="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                                        </Trigger>
                                        <DataTrigger Binding="{Binding IsSelected}" Value="True">
                                            <Setter Property="BorderBrush"
                                                    Value="{DynamicResource Brush.Accent.Primary}" />
                                            <Setter Property="BorderThickness" Value="2" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>

                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="2*" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <Border x:Name="CardImageContainer"
                                        CornerRadius="12,12,0,0"
                                        ClipToBounds="True">
                                    <Border.Style>
                                        <Style TargetType="{x:Type Border}">
                                            <Setter Property="Background">
                                                <Setter.Value>
                                                    <ImageBrush
                                                        ImageSource="/VintageStoryModManager;component/Resources/mod-default.png"
                                                        Stretch="UniformToFill"
                                                        AlignmentX="Center"
                                                        AlignmentY="Top" />
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding HasModDatabasePreviewImage}"
                                                             Value="True">
                                                    <Setter Property="Background">
                                                        <Setter.Value>
                                                            <ImageBrush ImageSource="{Binding ModDatabasePreviewImage}"
                                                                        Stretch="UniformToFill"
                                                                        AlignmentX="Center"
                                                                        AlignmentY="Top" />
                                                        </Setter.Value>
                                                    </Setter>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <Grid>
                                        <TextBlock Text="Installed"
                                                   Margin="8"
                                                   Padding="6,2"
                                                   HorizontalAlignment="Left"
                                                   VerticalAlignment="Top"
                                                   FontSize="12"
                                                   FontWeight="SemiBold"
                                                   Foreground="{DynamicResource Brush.Text.Emphasis}"
                                                   Background="{DynamicResource Brush.Overlay.Success.Background}">
                                            <TextBlock.Style>
                                                <Style TargetType="{x:Type TextBlock}">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsInstalled}" Value="True">
                                                            <Setter Property="Visibility" Value="Visible" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <StackPanel HorizontalAlignment="Right"
                                                    VerticalAlignment="Top"
                                                    Margin="0,8,8,0"
                                                    Orientation="Vertical">
                                            <Border Background="{DynamicResource Brush.DataGrid.Background}"
                                                    CornerRadius="4"
                                                    Padding="3">
                                                <Border.Style>
                                                    <Style TargetType="{x:Type Border}">
                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding LatestReleaseIsCompatible}"
                                                                         Value="True">
                                                                <Setter Property="Visibility" Value="Visible" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <TextBlock Text="Compatible"
                                                           Foreground="{DynamicResource Brush.Text.Body}"
                                                           FontSize="16" />
                                            </Border>
                                            <Border Background="{DynamicResource Brush.DataGrid.Background}"
                                                    CornerRadius="4"
                                                    Padding="3"
                                                    Margin="0,4,0,0">
                                                <Border.Style>
                                                    <Style TargetType="{x:Type Border}">
                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding HasLatestReleaseUserReport}"
                                                                         Value="True">
                                                                <Setter Property="Visibility" Value="Visible" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <TextBlock Text="{Binding LatestReleaseUserReportDisplay}"
                                                           Foreground="{DynamicResource Brush.Text.Body}"
                                                           FontSize="14"
                                                           ToolTip="{Binding LatestReleaseUserReportTooltip}" />
                                            </Border>
                                        </StackPanel>
                                    </Grid>
                                </Border>

                                <Border Grid.Row="1"
                                        Background="{DynamicResource Brush.Panel.Primary.Background.Solid}"
                                        Padding="12,10,12,12"
                                        CornerRadius="0,0,12,12">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <StackPanel Grid.Column="0"
                                                    Grid.RowSpan="2"
                                                    Orientation="Vertical">
                                            <Button Command="{Binding OpenModDatabasePageCommand}"
                                                    FontSize="24"
                                                    FontWeight="SemiBold"
                                                    Padding="0"
                                                    Margin="0,0,0,4"
                                                    Background="Transparent"
                                                    BorderThickness="0"
                                                    HorizontalAlignment="Left"
                                                    Cursor="Hand"
                                                    IsEnabled="{Binding HasModDatabasePageLink}">
                                                <Button.Style>
                                                    <Style TargetType="{x:Type Button}">
                                                        <Setter Property="Foreground"
                                                                Value="{DynamicResource Brush.Text.Primary}" />
                                                        <Setter Property="Template">
                                                            <Setter.Value>
                                                                <ControlTemplate TargetType="{x:Type Button}">
                                                                    <ContentPresenter RecognizesAccessKey="True" />
                                                                </ControlTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                        <Style.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Foreground"
                                                                        Value="{DynamicResource Brush.Button.Primary.Background.Hover}" />
                                                            </Trigger>
                                                            <Trigger Property="IsEnabled" Value="False">
                                                                <Setter Property="Foreground"
                                                                        Value="{DynamicResource Brush.Text.Placeholder}" />
                                                                <Setter Property="Cursor" Value="Arrow" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                                <StackPanel Orientation="Horizontal"
                                                            VerticalAlignment="Center"
                                                            HorizontalAlignment="Left"
                                                            Margin="0">
                                                    <TextBlock Text="{Binding DisplayName}"
                                                               VerticalAlignment="Center"
                                                               TextTrimming="CharacterEllipsis"
                                                               TextWrapping="NoWrap"
                                                               Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}" />
                                                    <TextBlock Text="&#xE71B;"
                                                               FontFamily="Segoe MDL2 Assets"
                                                               Margin="6,0,0,0"
                                                               VerticalAlignment="Center"
                                                               Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}" />
                                                </StackPanel>
                                            </Button>
                                            <TextBlock Text="{Binding DescriptionDisplay}"
                                                       Margin="0,4,0,6"
                                                       TextWrapping="Wrap"
                                                       TextTrimming="CharacterEllipsis"
                                                       FontSize="20"
                                                       Foreground="{DynamicResource Brush.Text.Primary}"
                                                       MaxHeight="60" />
                                            <TextBlock Text="{Binding DatabaseTagsDisplay}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource Brush.Text.Placeholder}"
                                                       TextTrimming="CharacterEllipsis"
                                                       TextWrapping="NoWrap">
                                                <TextBlock.Style>
                                                    <Style TargetType="{x:Type TextBlock}">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding DatabaseTagsDisplay}"
                                                                         Value="â€”">
                                                                <Setter Property="Visibility" Value="Collapsed" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1"
                                                    Grid.Row="0"
                                                    Orientation="Vertical"
                                                    HorizontalAlignment="Right"
                                                    Margin="12,0,0,0">
                                            <StackPanel Orientation="Horizontal"
                                                        Margin="0,0,0,6"
                                                        VerticalAlignment="Top">
                                                <TextBlock Text="&#xE118;"
                                                           FontFamily="Segoe MDL2 Assets"
                                                           FontSize="14"
                                                           Margin="0,0,4,0"
                                                           Foreground="{DynamicResource Brush.Text.Primary}" />
                                                <TextBlock FontSize="20"
                                                           FontWeight="SemiBold"
                                                           Foreground="{DynamicResource Brush.Text.Primary}">
                                                    <TextBlock.Text>
                                                        <MultiBinding
                                                            Converter="{StaticResource IMM.DownloadMetricDisplayConverter}">
                                                            <Binding Path="DataContext.IsShowingRecentDownloadMetric"
                                                                     RelativeSource="{RelativeSource AncestorType=ListView}" />
                                                            <Binding Path="DownloadsDisplay" />
                                                            <Binding Path="RecentDownloadsDisplay" />
                                                            <Binding Path="TenDayDownloadsDisplay" />
                                                            <Binding Path="DataContext.ModDatabaseAutoLoadMode"
                                                                     RelativeSource="{RelativeSource AncestorType=ListView}" />
                                                        </MultiBinding>
                                                    </TextBlock.Text>
                                                </TextBlock>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="&#xE15F;"
                                                           FontFamily="Segoe MDL2 Assets"
                                                           FontSize="14"
                                                           Margin="0,0,4,0"
                                                           Foreground="{DynamicResource Brush.Text.Primary}" />
                                                <TextBlock Text="{Binding CommentsDisplay}"
                                                           FontSize="20"
                                                           FontWeight="SemiBold"
                                                           Foreground="{DynamicResource Brush.Text.Primary}" />
                                            </StackPanel>
                                        </StackPanel>
                                        <Button Grid.Column="1"
                                                Grid.Row="1"
                                                Padding="12,6"
                                                Width="90"
                                                Height="30"
                                                HorizontalAlignment="Right"
                                                Margin="0,12,0,0"
                                                Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                                                BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                                                Click="InstallModButton_OnClick"
                                                ToolTip="{Binding InstallButtonToolTip}">
                                            <Button.Style>
                                                <Style TargetType="{x:Type Button}"
                                                       BasedOn="{StaticResource {x:Type Button}}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                    <Setter Property="VerticalContentAlignment" Value="Center" />
                                                    <Setter Property="IsEnabled"
                                                            Value="{Binding HasDownloadableRelease}" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsInstalled}" Value="True">
                                                            <Setter Property="Visibility" Value="Collapsed" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                            <TextBlock Text="Install"
                                                       VerticalAlignment="Center"
                                                       Foreground="{DynamicResource Brush.Text.Primary}" />
                                        </Button>
                                    </Grid>
                                </Border>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
            <Button Grid.Row="1"
                    Content="Load more pages"
                    Command="{Binding LoadMoreModDatabaseResultsCommand}"
                    Margin="546,0,570,10"
                    Background="Transparent"
                    BorderBrush="Transparent"
                    BorderThickness="0"
                    Padding="0"
                    Foreground="{DynamicResource Brush.Accent.Primary}"
                    Cursor="Hand"
                    FontSize="14"
                    FontWeight="SemiBold" Height="25" VerticalAlignment="Bottom">
                <Button.Style>
                    <Style TargetType="{x:Type Button}">
                        <Setter Property="Visibility" Value="Collapsed" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type Button}">
                                    <ContentPresenter HorizontalAlignment="Center"
                                                      VerticalAlignment="Center" />
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Style.Triggers>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding SearchModDatabase}" Value="True" />
                                    <Condition Binding="{Binding IsLoadMoreModDatabaseButtonVisible}" Value="True" />
                                    <Condition Binding="{Binding IsLoadMoreModDatabaseScrollThresholdReached}"
                                               Value="True" />
                                    <Condition Binding="{Binding IsModDatabaseLoading}" Value="False" />
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Visibility" Value="Visible" />
                            </MultiDataTrigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
            </Button>
        </Grid>
        <Grid x:Name="BOTTOM" Margin="16,4,16,4" Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <Border x:Name="StatusTextBorder"
                    HorizontalAlignment="Left"
                    Height="50"
                    VerticalAlignment="Center"
                    Width="376"
                    Background="Transparent"
                    BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Light}"
                    BorderThickness="0,0,2,2"
                    CornerRadius="3"
                    SnapsToDevicePixels="True">
                <Border Background="{DynamicResource Brush.SunkenSurface.Background}"
                        BorderBrush="{DynamicResource Brush.SunkenSurface.Bevel.Dark}"
                        BorderThickness="2,2,0,0"
                        CornerRadius="3"
                        SnapsToDevicePixels="True">
                    <Grid>
                        <TextBlock Grid.Column="0"
                                   Text="{Binding StatusMessage}"
                                   TextWrapping="Wrap"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   FontSize="14"
                                   Foreground="{DynamicResource Brush.Text.Primary}"
                                   FontWeight="Bold"
                                   Padding="4,2,4,2">
                            <TextBlock.Style>
                                <Style TargetType="{x:Type TextBlock}">
                                    <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Primary}" />
                                    <Setter Property="Visibility" Value="Visible" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasStatusMessage}" Value="True">
                                            <Setter Property="Visibility" Value="Visible" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding IsErrorStatus}" Value="True">
                                            <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Emphasis}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </Grid>
                </Border>
            </Border>

            <StackPanel Grid.Column="1"
                        Orientation="Horizontal"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Top" Margin="0,18,0,0">
                <Button x:Name="UpdateAllButton"
                        Content="{Binding DataContext.UpdateAllButtonLabel, RelativeSource={RelativeSource AncestorType=Window}, FallbackValue=Update All}"
                        Margin="0,0,4,0"
                        Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                        BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                        Click="UpdateAllModsMenuItem_OnClick" Padding="6,6,6,6" MinHeight="32" MinWidth="125" />
                <Button Content="Open Logs Folder"
                        Margin="0,0,4,0"
                        Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                        BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                        Click="OpenLogsFolderButton_OnClick" Padding="6,6,6,6" MinHeight="32" MinWidth="125" />
                <Button Content="Open Config Folder"
                        Margin="0,0,4,0"
                        Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                        BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                        Click="OpenConfigFolderButton_OnClick" Padding="6,6,6,6" MinHeight="32" MinWidth="125" />
                <Button Content="Open Mods Folder"
                        Margin="0,0,4,0"
                        Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                        BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                        Click="OpenModFolderButton_OnClick" Padding="6,6,6,6" MinHeight="32" MinWidth="125" />
                <Button x:Name="LaunchGameButton"
                        Content="Launch Vintage Story"
                        Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                        BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                        Click="LaunchGameButton_OnClick"
                        FontWeight="Bold" MinHeight="32" MinWidth="150" />
            </StackPanel>
            <ui:ProgressRing
                HorizontalAlignment="Left"
                IsActive="{Binding IsBusy}"
                Visibility="{Binding IsBusy, Converter={StaticResource IMM.VisibleWhenTrueConverter}}"
                Foreground="{DynamicResource Brush.Accent.Primary}" Margin="388,0,0,0" VerticalAlignment="Stretch"
                Width="40" Height="40" />
        </Grid>
        <Canvas x:Name="ModInfoOverlay" Grid.RowSpan="3" Panel.ZIndex="400">
            <Border Background="{DynamicResource Brush.ModCard.Background.Active}" x:Name="MODINFO_border"
                    BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                    BorderThickness="0"
                    CornerRadius="15,15,15,15" Height="201" Width="326"
                    Canvas.Left="1060"
                    Canvas.Top="350"
                    Panel.ZIndex="400"
                    MouseLeftButtonDown="ModInfoBorder_OnMouseLeftButtonDown"
                    MouseLeftButtonUp="ModInfoBorder_OnMouseLeftButtonUp"
                    MouseMove="ModInfoBorder_OnMouseMove"
                    LostMouseCapture="ModInfoBorder_OnLostMouseCapture">
                <Border.Style>
                    <Style TargetType="{x:Type Border}">
                        <Setter Property="Visibility" Value="Collapsed" />
                        <Setter Property="IsHitTestVisible" Value="False" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding HasSelectedMods}" Value="True">
                                <Setter Property="Visibility" Value="Visible" />
                                <Setter Property="IsHitTestVisible" Value="True" />
                            </DataTrigger>
                            <DataTrigger Binding="{Binding IsViewingCloudModlists}" Value="True">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Setter Property="IsHitTestVisible" Value="False" />
                            </DataTrigger>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding SearchModDatabase}" Value="True" />
                                    <Condition Binding="{Binding UseModDbDesignView}" Value="True" />
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Setter Property="IsHitTestVisible" Value="False" />
                            </MultiDataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
                <Border.Effect>
                    <DropShadowEffect Color="{DynamicResource Palette.BaseSurface.Shadowed}"
                                      BlurRadius="20"
                                      Direction="270"
                                      ShadowDepth="8"
                                      Opacity="0.2" />
                </Border.Effect>
                <Grid x:Name="MODINFO_grid" Height="223" Width="324" Background="Transparent">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="53*" />
                        <ColumnDefinition Width="28*" />
                    </Grid.ColumnDefinitions>
                    <Grid.Effect>
                        <DropShadowEffect BlurRadius="6"
                                          Direction="270"
                                          ShadowDepth="4"
                                          Opacity="0.1"
                                          Color="{DynamicResource Palette.BaseSurface.Shadowed}" />
                    </Grid.Effect>
                    <Button x:Name="SelectedModDatabasePageButton"
                            Padding="12,6"
                            Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                            BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                            Visibility="Visible"
                            IsEnabled="False"
                            Click="ModDatabasePageButton_OnClick"
                            ToolTip="{Binding ModDatabasePageUrlDisplay}"
                            VerticalContentAlignment="Center"
                            Content="Mod Page" HorizontalAlignment="Center" VerticalAlignment="Top" Grid.Column="1"
                            Margin="0,45,0,0" MinHeight="32" MinWidth="92" />
                    <Button x:Name="SelectedModEditConfigButton"
                            Padding="12,6"
                            Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                            BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                            Visibility="Visible"
                            IsEnabled="False"
                            Click="EditConfigButton_OnClick"
                            VerticalContentAlignment="Stretch"
                            Content="Edit Config" HorizontalContentAlignment="Stretch" HorizontalAlignment="Center"
                            VerticalAlignment="Top" Margin="0,10,0,0" Grid.Column="1" MinHeight="32" MinWidth="92" />
                    <Button x:Name="SelectedModDeleteButton"
                            Padding="12,6"
                            Background="{DynamicResource Brush.Status.Error}"
                            BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                            Visibility="Visible"
                            IsEnabled="False"
                            Click="DeleteModButton_OnClick" HorizontalAlignment="Center" VerticalAlignment="Top"
                            Margin="0,80,0,0" Grid.Column="1" MinHeight="32" MinWidth="92">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}" BasedOn="{StaticResource {x:Type Button}}">
                                <Setter Property="ToolTip" Value="{Binding DisplayName, StringFormat=Delete \{0\}}" />
                                <Style.Triggers>
                                    <DataTrigger
                                        Binding="{Binding DataContext.HasMultipleSelectedMods, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                        Value="True">
                                        <Setter Property="ToolTip" Value="Delete selected mods" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">

                            <TextBlock Text="Delete" VerticalAlignment="Center"
                                       Foreground="{DynamicResource Brush.Text.Primary}" />
                        </StackPanel>
                    </Button>
                    <Button x:Name="SelectedModCopyForServerButton"
                            Padding="12,6"
                            Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                            BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                            Visibility="Visible"
                            IsEnabled="False"
                            Click="SelectedModCopyForServerButton_OnClick"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Top"
                            Margin="0,117,0,0"
                            Grid.Column="1"
                            MinHeight="32" MinWidth="92"
                            VerticalContentAlignment="Center"
                            HorizontalContentAlignment="Center"
                            Content="Copy for Server" />
                    <Button x:Name="SelectedModFixButton"
                            Padding="12,6"
                            Background="{DynamicResource Brush.Status.Error}"
                            BorderBrush="{DynamicResource Brush.Text.Primary}"
                            Visibility="Collapsed"
                            IsEnabled="False"
                            Click="FixModButton_OnClick"
                            ToolTip="Resolve dependency issues" HorizontalAlignment="Center" VerticalAlignment="Top"
                            Margin="0,115,0,0" Grid.Column="1" MinHeight="32" MinWidth="92" d:IsHidden="True">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}" BasedOn="{StaticResource {x:Type Button}}">
                                <Setter Property="Background" Value="{DynamicResource Brush.Status.Error}" />
                                <Setter Property="BorderBrush" Value="{DynamicResource Brush.Text.Primary}" />
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <Border x:Name="Root"
                                                    Background="{TemplateBinding Background}"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    CornerRadius="{TemplateBinding ui:ControlHelper.CornerRadius}"
                                                    Padding="{TemplateBinding Padding}"
                                                    SnapsToDevicePixels="True">
                                                <ContentPresenter
                                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                    RecognizesAccessKey="True" />
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsEnabled" Value="False">
                                                    <Setter TargetName="Root" Property="Opacity" Value="0.6" />
                                                </Trigger>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="Root" Property="Background"
                                                            Value="{DynamicResource Brush.Status.Error}" />
                                                    <Setter TargetName="Root" Property="BorderBrush"
                                                            Value="{DynamicResource Brush.Text.Primary}" />
                                                </Trigger>
                                                <Trigger Property="IsPressed" Value="True">
                                                    <Setter TargetName="Root" Property="Background"
                                                            Value="{DynamicResource Brush.Status.Error}" />
                                                    <Setter TargetName="Root" Property="BorderBrush"
                                                            Value="{DynamicResource Brush.Text.Primary}" />
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Button.Style>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">

                            <TextBlock Text="Fix" VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>
                    <Button x:Name="SelectedModInstallButton"
                            Padding="12,6"
                            Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                            BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                            Visibility="Visible"
                            IsEnabled="False"
                            Click="InstallModButton_OnClick"
                            ToolTip="{Binding InstallButtonToolTip}" HorizontalAlignment="Center"
                            VerticalAlignment="Top" Margin="0,10,0,0" Grid.Column="1" MinHeight="32" MinWidth="92">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="Install" VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>
                    <ComboBox x:Name="SelectedModVersionComboBox"
                              Width="166"
                              Padding="12,6"
                              Background="{DynamicResource Brush.ComboBox.Background.Normal}"
                              BorderBrush="{DynamicResource Brush.ComboBox.Border.Normal}"
                              BorderThickness="1"
                              Foreground="{DynamicResource Brush.Text.Primary}"
                              ui:ControlHelper.CornerRadius="6"
                              ItemsSource="{Binding SelectedMod.VersionOptions}"
                              SelectedItem="{Binding SelectedMod.SelectedVersionOption, Mode=TwoWay}"
                              SelectionChanged="SelectedModVersionComboBox_OnSelectionChanged"
                              DropDownOpened="SelectedModVersionComboBox_OnDropDownOpened"
                              VerticalAlignment="Top" HorizontalAlignment="Left" Margin="17,155,0,0" MinHeight="32">
                        <ComboBox.Resources>
                            <DataTemplate x:Key="SelectedModVersionTemplate"
                                          DataType="{x:Type viewModels:ModVersionOptionViewModel}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding SelectionDisplay}" />
                                    <TextBlock Text="âœ“" Foreground="{DynamicResource Brush.Accent.Primary}"
                                               Margin="6,0,0,0">
                                        <TextBlock.Style>
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsCompatible}" Value="True">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </StackPanel>
                            </DataTemplate>
                        </ComboBox.Resources>
                        <ComboBox.Style>
                            <Style TargetType="{x:Type ComboBox}" BasedOn="{StaticResource {x:Type ComboBox}}">
                                <Setter Property="Visibility" Value="Visible" />
                                <Setter Property="IsEnabled" Value="False" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedMod.HasVersionOptions}" Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                        <Setter Property="IsEnabled" Value="True" />
                                    </DataTrigger>
                                    <DataTrigger
                                        Binding="{Binding DataContext.SearchModDatabase, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                        Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                        <Setter Property="IsEnabled" Value="False" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding HasMultipleSelectedMods}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                        <Setter Property="IsEnabled" Value="False" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ComboBox.Style>
                        <ComboBox.ItemTemplate>
                            <StaticResource ResourceKey="SelectedModVersionTemplate" />
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                    <Button x:Name="SelectedModUpdateButton"
                            Padding="6,6,6,6"
                            Background="{DynamicResource Brush.Button.Primary.Background.Normal}"
                            BorderBrush="{DynamicResource Brush.Panel.Secondary.Background.Solid}"
                            Visibility="Visible"
                            IsEnabled="False"
                            Click="UpdateModButton_OnClick"
                            ToolTip="{Binding UpdateButtonToolTip}" HorizontalAlignment="Center"
                            VerticalAlignment="Top" Grid.Column="1" Margin="0,154,0,0" MinHeight="32" MaxHeight="33"
                            MinWidth="100" Width="108">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Width="90">
                                <Run Text="Update to latest" /><LineBreak /><Run />
                            </TextBlock>
                        </StackPanel>
                    </Button>
                    <TextBlock
                        FontWeight="SemiBold"
                        Foreground="{DynamicResource Brush.Text.Primary}"
                        TextAlignment="Left" VerticalAlignment="Top" HorizontalAlignment="Left" Width="189"
                        Margin="23,15,0,0" Height="25" FontSize="14">
                        <TextBlock.Style>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Text" Value="{Binding SelectedMod.DisplayName}" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding HasMultipleSelectedMods}" Value="True">
                                        <Setter Property="Text" Value="Multiple mods selected" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                    <TextBlock
                        Text="{Binding SelectedMod.DescriptionDisplay}"
                        Foreground="{DynamicResource Brush.Text.Primary}"
                        MaxWidth="420"
                        TextWrapping="Wrap"
                        TextTrimming="CharacterEllipsis"
                        TextAlignment="Left" HorizontalAlignment="Left" VerticalAlignment="Top" Width="189"
                        Height="105" MaxHeight="143" Margin="23,45,0,0" FontSize="14">
                        <TextBlock.Style>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Visibility" Value="Visible" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding HasMultipleSelectedMods}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </Grid>
            </Border>
        </Canvas>

    </Grid>
</Window>